{
  "hash": "d4f302d0460a3915eab21f18e206c239",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Hands-on Exercise 11\"\ndate: \"October 27, 2024\"\ndate-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  freeze: true\n---\n\n\n\n\n\n# Overview\n\n**Geographically weighted regression (GWR)** is a spatial statistical technique that takes non-stationary variables into consideration (e.g., climate; demographic factors; physical environment characteristics) and models the local relationships between these independent variables and an outcome of interest (also known as dependent variable). In this hands-on exercise, you will learn how to build [hedonic pricing](https://www.investopedia.com/terms/h/hedonicpricing.asp) models by using GWR methods. The dependent variable is the resale prices of condominium in 2015. The independent variables are divided into either structural and locational.\n\n## The Data\n\nTwo data sets will be used in this model building exercise, they are:\n\n-   URA Master Plan subzone boundary in shapefile format (i.e. *MP14_SUBZONE_WEB_PL*)\n\n-   condo_resale_2015 in csv format (i.e. *condo_resale_2015.csv*)\n\n## Loading the Data\n\nThe code chunks below installs and launches the necessary R packages into R environment.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(olsrr, corrplot, ggpubr, sf, spdep, GWmodel, tmap, tidyverse, gtsummary, ggstatsplot, performance)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncondo_resale <- read_csv(\"data/aspatial/Condo_resale_2015.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 1436 Columns: 23\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (23): LATITUDE, LONGITUDE, POSTCODE, SELLING_PRICE, AREA_SQM, AGE, PROX_...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\nmpsz <- st_read(dsn = \"data/geospatial\", layer = \"MP14_SUBZONE_WEB_PL\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `/Users/jezelei/jezeleii/IS415-GA/In-Class_Exercise/InClassEx11/data/geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n```\n\n\n:::\n\n```{.r .cell-code}\ncondo_resale_sf <- st_as_sf(condo_resale,\n                            coords = c(\"LONGITUDE\", \"LATITUDE\"),\n                            crs=4326) %>%\n  st_transform(crs=3414)\n```\n:::\n\n\n\n\n\n# Correlation Analysis\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggcorrmat(condo_resale[, 5:23])\n```\n\n::: {.cell-output-display}\n![](InClassEx11_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\n\n## Building a Hedonic Pricing Model using Multiple Linear Regression Method\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncondo_mlr <- lm(formula = SELLING_PRICE ~ AREA_SQM + AGE  + \n                        PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE    + \n                        PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n                        PROX_PRIMARY_SCH + PROX_TOP_PRIMARY_SCH + PROX_SHOPPING_MALL   +\n                        PROX_BUS_STOP + PROX_SUPERMARKET + \n                        NO_Of_UNITS + FAMILY_FRIENDLY +\n                        FREEHOLD + LEASEHOLD_99YR, \n                data= condo_resale_sf)\n\nsummary(condo_mlr)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + PROX_CHILDCARE + \n    PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n    PROX_PRIMARY_SCH + PROX_TOP_PRIMARY_SCH + PROX_SHOPPING_MALL + \n    PROX_BUS_STOP + PROX_SUPERMARKET + NO_Of_UNITS + FAMILY_FRIENDLY + \n    FREEHOLD + LEASEHOLD_99YR, data = condo_resale_sf)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3471622  -292738   -29240   243892 12248767 \n\nCoefficients:\n                       Estimate Std. Error t value Pr(>|t|)    \n(Intercept)           573751.28  127638.06   4.495 7.52e-06 ***\nAREA_SQM               12761.36     368.29  34.651  < 2e-16 ***\nAGE                   -24692.74    2763.89  -8.934  < 2e-16 ***\nPROX_CBD              -78180.29    6162.85 -12.686  < 2e-16 ***\nPROX_CHILDCARE       -302488.54  109652.58  -2.759 0.005879 ** \nPROX_ELDERLYCARE      175754.05   41564.59   4.228 2.50e-05 ***\nPROX_URA_GROWTH_AREA   41307.30   12085.88   3.418 0.000649 ***\nPROX_MRT             -304020.34   57698.13  -5.269 1.58e-07 ***\nPROX_PARK             566632.51   66299.83   8.547  < 2e-16 ***\nPROX_PRIMARY_SCH      165612.27   64087.60   2.584 0.009861 ** \nPROX_TOP_PRIMARY_SCH   12466.53   18070.39   0.690 0.490378    \nPROX_SHOPPING_MALL   -204394.19   42841.56  -4.771 2.02e-06 ***\nPROX_BUS_STOP         661868.66  137592.25   4.810 1.67e-06 ***\nPROX_SUPERMARKET      -26700.56   75744.23  -0.353 0.724509    \nNO_Of_UNITS             -227.10      90.05  -2.522 0.011777 *  \nFAMILY_FRIENDLY       146824.63   46967.52   3.126 0.001807 ** \nFREEHOLD              284944.17   76776.96   3.711 0.000214 ***\nLEASEHOLD_99YR        -82435.12   77547.07  -1.063 0.287948    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 756200 on 1418 degrees of freedom\nMultiple R-squared:  0.6512,\tAdjusted R-squared:  0.647 \nF-statistic: 155.7 on 17 and 1418 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n\n\nFront - Dependent Variable\n\n-   Matrix does not work here, needs to be a data frame input\n\n# Generating tidy linear regression report\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nols_regress(condo_mlr)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                             Model Summary                               \n------------------------------------------------------------------------\nR                            0.807       RMSE                751474.904 \nR-Squared                    0.651       MSE                5.71883e+11 \nAdj. R-Squared               0.647       Coef. Var               43.183 \nPred R-Squared               0.637       AIC                  42970.757 \nMAE                     412256.886       SBC                  43070.880 \n------------------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                                   ANOVA                                     \n----------------------------------------------------------------------------\n                    Sum of                                                  \n                   Squares          DF     Mean Square       F         Sig. \n----------------------------------------------------------------------------\nRegression    1.513717e+15          17    8.904216e+13      155.7    0.0000 \nResidual      8.109301e+14        1418     5.71883e+11                      \nTotal         2.324647e+15        1435                                      \n----------------------------------------------------------------------------\n\n                                               Parameter Estimates                                                \n-----------------------------------------------------------------------------------------------------------------\n               model           Beta    Std. Error    Std. Beta       t        Sig           lower          upper \n-----------------------------------------------------------------------------------------------------------------\n         (Intercept)     573751.278    127638.065                   4.495    0.000     323371.554     824131.002 \n            AREA_SQM      12761.359       368.285        0.583     34.651    0.000      12038.916      13483.801 \n                 AGE     -24692.742      2763.888       -0.167     -8.934    0.000     -30114.490     -19270.994 \n            PROX_CBD     -78180.291      6162.848       -0.267    -12.686    0.000     -90269.570     -66091.011 \n      PROX_CHILDCARE    -302488.540    109652.582       -0.079     -2.759    0.006    -517587.251     -87389.828 \n    PROX_ELDERLYCARE     175754.051     41564.587        0.085      4.228    0.000      94219.364     257288.739 \nPROX_URA_GROWTH_AREA      41307.302     12085.880        0.064      3.418    0.001      17599.176      65015.428 \n            PROX_MRT    -304020.341     57698.134       -0.116     -5.269    0.000    -417203.214    -190837.468 \n           PROX_PARK     566632.510     66299.830        0.149      8.547    0.000     436576.220     696688.799 \n    PROX_PRIMARY_SCH     165612.275     64087.605        0.064      2.584    0.010      39895.570     291328.979 \nPROX_TOP_PRIMARY_SCH      12466.530     18070.387        0.014      0.690    0.490     -22981.035      47914.095 \n  PROX_SHOPPING_MALL    -204394.191     42841.560       -0.107     -4.771    0.000    -288433.839    -120354.544 \n       PROX_BUS_STOP     661868.663    137592.246        0.130      4.810    0.000     391962.435     931774.891 \n    PROX_SUPERMARKET     -26700.565     75744.227       -0.007     -0.353    0.725    -175283.346     121882.216 \n         NO_Of_UNITS       -227.105        90.049       -0.049     -2.522    0.012       -403.748        -50.461 \n     FAMILY_FRIENDLY     146824.630     46967.516        0.058      3.126    0.002      54691.350     238957.911 \n            FREEHOLD     284944.168     76776.958        0.111      3.711    0.000     134335.542     435552.794 \n      LEASEHOLD_99YR     -82435.124     77547.067       -0.032     -1.063    0.288    -234554.424      69684.177 \n-----------------------------------------------------------------------------------------------------------------\n```\n\n\n:::\n:::\n\n\n\n\n\n# Variable Selection\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncondo_fw_mlr <- ols_step_forward_p(\n  condo_mlr, \n  p_val = 0.05, \n  details= FALSE) \ncondo_fw_mlr\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n                                     Stepwise Summary                                      \n-----------------------------------------------------------------------------------------\nStep    Variable                   AIC          SBC         SBIC         R2       Adj. R2 \n-----------------------------------------------------------------------------------------\n 0      Base Model              44449.068    44459.608    40371.747    0.00000    0.00000 \n 1      AREA_SQM                43587.753    43603.562    39510.886    0.45184    0.45146 \n 2      PROX_CBD                43243.523    43264.602    39167.188    0.56928    0.56868 \n 3      PROX_PARK               43177.691    43204.039    39101.339    0.58915    0.58829 \n 4      FREEHOLD                43125.474    43157.092    39049.189    0.60438    0.60327 \n 5      AGE                     43069.222    43106.109    38993.180    0.62010    0.61878 \n 6      PROX_ELDERLYCARE        43046.515    43088.672    38970.562    0.62659    0.62502 \n 7      PROX_SHOPPING_MALL      43020.990    43068.417    38945.226    0.63367    0.63188 \n 8      PROX_URA_GROWTH_AREA    43009.092    43061.788    38933.427    0.63720    0.63517 \n 9      PROX_MRT                42999.058    43057.024    38923.505    0.64023    0.63796 \n 10     PROX_BUS_STOP           42984.951    43048.186    38909.605    0.64424    0.64175 \n 11     FAMILY_FRIENDLY         42981.085    43049.590    38905.823    0.64569    0.64296 \n 12     NO_Of_UNITS             42975.246    43049.021    38900.121    0.64762    0.64465 \n 13     PROX_CHILDCARE          42971.858    43050.902    38896.843    0.64894    0.64573 \n 14     PROX_PRIMARY_SCH        42966.758    43051.072    38891.905    0.65067    0.64723 \n-----------------------------------------------------------------------------------------\n\nFinal Model Output \n------------------\n\n                                Model Summary                                 \n-----------------------------------------------------------------------------\nR                            0.807       RMSE                     751998.679 \nR-Squared                    0.651       MSE                571471422208.592 \nAdj. R-Squared               0.647       Coef. Var                    43.168 \nPred R-Squared               0.638       AIC                       42966.758 \nMAE                     414819.628       SBC                       43051.072 \n-----------------------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                                     ANOVA                                       \n--------------------------------------------------------------------------------\n                    Sum of                                                      \n                   Squares          DF         Mean Square       F         Sig. \n--------------------------------------------------------------------------------\nRegression    1.512586e+15          14        1.080418e+14    189.059    0.0000 \nResidual      8.120609e+14        1421    571471422208.592                      \nTotal         2.324647e+15        1435                                          \n--------------------------------------------------------------------------------\n\n                                               Parameter Estimates                                                \n-----------------------------------------------------------------------------------------------------------------\n               model           Beta    Std. Error    Std. Beta       t        Sig           lower          upper \n-----------------------------------------------------------------------------------------------------------------\n         (Intercept)     527633.222    108183.223                   4.877    0.000     315417.244     739849.200 \n            AREA_SQM      12777.523       367.479        0.584     34.771    0.000      12056.663      13498.382 \n            PROX_CBD     -77131.323      5763.125       -0.263    -13.384    0.000     -88436.469     -65826.176 \n           PROX_PARK     570504.807     65507.029        0.150      8.709    0.000     442003.938     699005.677 \n            FREEHOLD     350599.812     48506.485        0.136      7.228    0.000     255447.802     445751.821 \n                 AGE     -24687.739      2754.845       -0.167     -8.962    0.000     -30091.739     -19283.740 \n    PROX_ELDERLYCARE     185575.623     39901.864        0.090      4.651    0.000     107302.737     263848.510 \n  PROX_SHOPPING_MALL    -220947.251     36561.832       -0.115     -6.043    0.000    -292668.213    -149226.288 \nPROX_URA_GROWTH_AREA      39163.254     11754.829        0.060      3.332    0.001      16104.571      62221.936 \n            PROX_MRT    -294745.107     56916.367       -0.112     -5.179    0.000    -406394.234    -183095.980 \n       PROX_BUS_STOP     682482.221    134513.243        0.134      5.074    0.000     418616.359     946348.082 \n     FAMILY_FRIENDLY     146307.576     46893.021        0.057      3.120    0.002      54320.593     238294.560 \n         NO_Of_UNITS       -245.480        87.947       -0.053     -2.791    0.005       -418.000        -72.961 \n      PROX_CHILDCARE    -318472.751    107959.512       -0.084     -2.950    0.003    -530249.889    -106695.613 \n    PROX_PRIMARY_SCH     159856.136     60234.599        0.062      2.654    0.008      41697.849     278014.424 \n-----------------------------------------------------------------------------------------------------------------\n```\n\n\n:::\n:::\n\n\n\n\n\nAny independent variable we add in, it will compare the variable at every iteration.\n\n# Building Backward Stepwise MLR\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncondo_bw_mlr <- ols_step_backward_p(\n  condo_mlr, \n  p_val = 0.05, \n  details= FALSE) \ncondo_bw_mlr\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n                                     Stepwise Summary                                      \n-----------------------------------------------------------------------------------------\nStep    Variable                   AIC          SBC         SBIC         R2       Adj. R2 \n-----------------------------------------------------------------------------------------\n 0      Full Model              42970.757    43070.880    38896.022    0.65116    0.64698 \n 1      PROX_SUPERMARKET        42968.883    43063.736    38894.120    0.65113    0.64720 \n 2      PROX_TOP_PRIMARY_SCH    42967.367    43056.951    38892.568    0.65101    0.64733 \n 3      LEASEHOLD_99YR          42966.758    43051.072    38891.905    0.65067    0.64723 \n-----------------------------------------------------------------------------------------\n\nFinal Model Output \n------------------\n\n                                Model Summary                                 \n-----------------------------------------------------------------------------\nR                            0.807       RMSE                     751998.679 \nR-Squared                    0.651       MSE                571471422208.592 \nAdj. R-Squared               0.647       Coef. Var                    43.168 \nPred R-Squared               0.638       AIC                       42966.758 \nMAE                     414819.628       SBC                       43051.072 \n-----------------------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                                     ANOVA                                       \n--------------------------------------------------------------------------------\n                    Sum of                                                      \n                   Squares          DF         Mean Square       F         Sig. \n--------------------------------------------------------------------------------\nRegression    1.512586e+15          14        1.080418e+14    189.059    0.0000 \nResidual      8.120609e+14        1421    571471422208.592                      \nTotal         2.324647e+15        1435                                          \n--------------------------------------------------------------------------------\n\n                                               Parameter Estimates                                                \n-----------------------------------------------------------------------------------------------------------------\n               model           Beta    Std. Error    Std. Beta       t        Sig           lower          upper \n-----------------------------------------------------------------------------------------------------------------\n         (Intercept)     527633.222    108183.223                   4.877    0.000     315417.244     739849.200 \n            AREA_SQM      12777.523       367.479        0.584     34.771    0.000      12056.663      13498.382 \n                 AGE     -24687.739      2754.845       -0.167     -8.962    0.000     -30091.739     -19283.740 \n            PROX_CBD     -77131.323      5763.125       -0.263    -13.384    0.000     -88436.469     -65826.176 \n      PROX_CHILDCARE    -318472.751    107959.512       -0.084     -2.950    0.003    -530249.889    -106695.613 \n    PROX_ELDERLYCARE     185575.623     39901.864        0.090      4.651    0.000     107302.737     263848.510 \nPROX_URA_GROWTH_AREA      39163.254     11754.829        0.060      3.332    0.001      16104.571      62221.936 \n            PROX_MRT    -294745.107     56916.367       -0.112     -5.179    0.000    -406394.234    -183095.980 \n           PROX_PARK     570504.807     65507.029        0.150      8.709    0.000     442003.938     699005.677 \n    PROX_PRIMARY_SCH     159856.136     60234.599        0.062      2.654    0.008      41697.849     278014.424 \n  PROX_SHOPPING_MALL    -220947.251     36561.832       -0.115     -6.043    0.000    -292668.213    -149226.288 \n       PROX_BUS_STOP     682482.221    134513.243        0.134      5.074    0.000     418616.359     946348.082 \n         NO_Of_UNITS       -245.480        87.947       -0.053     -2.791    0.005       -418.000        -72.961 \n     FAMILY_FRIENDLY     146307.576     46893.021        0.057      3.120    0.002      54320.593     238294.560 \n            FREEHOLD     350599.812     48506.485        0.136      7.228    0.000     255447.802     445751.821 \n-----------------------------------------------------------------------------------------------------------------\n```\n\n\n:::\n:::\n\n\n\n\n\n# Building Stepwise Multiple Linear Regression\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncondo_sb_mlr <- ols_step_both_p(\n  condo_mlr, \n  p_val = 0.05, \n  details= FALSE) \ncondo_sb_mlr\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n                                       Stepwise Summary                                        \n---------------------------------------------------------------------------------------------\nStep    Variable                       AIC          SBC         SBIC         R2       Adj. R2 \n---------------------------------------------------------------------------------------------\n 0      Base Model                  44449.068    44459.608    40371.747    0.00000    0.00000 \n 1      AREA_SQM (+)                43587.753    43603.562    39510.886    0.45184    0.45146 \n 2      PROX_CBD (+)                43243.523    43264.602    39167.188    0.56928    0.56868 \n 3      PROX_PARK (+)               43177.691    43204.039    39101.339    0.58915    0.58829 \n 4      FREEHOLD (+)                43125.474    43157.092    39049.189    0.60438    0.60327 \n 5      AGE (+)                     43069.222    43106.109    38993.180    0.62010    0.61878 \n 6      PROX_ELDERLYCARE (+)        43046.515    43088.672    38970.562    0.62659    0.62502 \n 7      PROX_SHOPPING_MALL (+)      43020.990    43068.417    38945.226    0.63367    0.63188 \n 8      PROX_URA_GROWTH_AREA (+)    43009.092    43061.788    38933.427    0.63720    0.63517 \n 9      PROX_MRT (+)                42999.058    43057.024    38923.505    0.64023    0.63796 \n 10     PROX_BUS_STOP (+)           42984.951    43048.186    38909.605    0.64424    0.64175 \n 11     FAMILY_FRIENDLY (+)         42981.085    43049.590    38905.823    0.64569    0.64296 \n 12     NO_Of_UNITS (+)             42975.246    43049.021    38900.121    0.64762    0.64465 \n 13     PROX_CHILDCARE (+)          42971.858    43050.902    38896.843    0.64894    0.64573 \n 14     PROX_PRIMARY_SCH (+)        42966.758    43051.072    38891.905    0.65067    0.64723 \n---------------------------------------------------------------------------------------------\n\nFinal Model Output \n------------------\n\n                                Model Summary                                 \n-----------------------------------------------------------------------------\nR                            0.807       RMSE                     751998.679 \nR-Squared                    0.651       MSE                571471422208.592 \nAdj. R-Squared               0.647       Coef. Var                    43.168 \nPred R-Squared               0.638       AIC                       42966.758 \nMAE                     414819.628       SBC                       43051.072 \n-----------------------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                                     ANOVA                                       \n--------------------------------------------------------------------------------\n                    Sum of                                                      \n                   Squares          DF         Mean Square       F         Sig. \n--------------------------------------------------------------------------------\nRegression    1.512586e+15          14        1.080418e+14    189.059    0.0000 \nResidual      8.120609e+14        1421    571471422208.592                      \nTotal         2.324647e+15        1435                                          \n--------------------------------------------------------------------------------\n\n                                               Parameter Estimates                                                \n-----------------------------------------------------------------------------------------------------------------\n               model           Beta    Std. Error    Std. Beta       t        Sig           lower          upper \n-----------------------------------------------------------------------------------------------------------------\n         (Intercept)     527633.222    108183.223                   4.877    0.000     315417.244     739849.200 \n            AREA_SQM      12777.523       367.479        0.584     34.771    0.000      12056.663      13498.382 \n            PROX_CBD     -77131.323      5763.125       -0.263    -13.384    0.000     -88436.469     -65826.176 \n           PROX_PARK     570504.807     65507.029        0.150      8.709    0.000     442003.938     699005.677 \n            FREEHOLD     350599.812     48506.485        0.136      7.228    0.000     255447.802     445751.821 \n                 AGE     -24687.739      2754.845       -0.167     -8.962    0.000     -30091.739     -19283.740 \n    PROX_ELDERLYCARE     185575.623     39901.864        0.090      4.651    0.000     107302.737     263848.510 \n  PROX_SHOPPING_MALL    -220947.251     36561.832       -0.115     -6.043    0.000    -292668.213    -149226.288 \nPROX_URA_GROWTH_AREA      39163.254     11754.829        0.060      3.332    0.001      16104.571      62221.936 \n            PROX_MRT    -294745.107     56916.367       -0.112     -5.179    0.000    -406394.234    -183095.980 \n       PROX_BUS_STOP     682482.221    134513.243        0.134      5.074    0.000     418616.359     946348.082 \n     FAMILY_FRIENDLY     146307.576     46893.021        0.057      3.120    0.002      54320.593     238294.560 \n         NO_Of_UNITS       -245.480        87.947       -0.053     -2.791    0.005       -418.000        -72.961 \n      PROX_CHILDCARE    -318472.751    107959.512       -0.084     -2.950    0.003    -530249.889    -106695.613 \n    PROX_PRIMARY_SCH     159856.136     60234.599        0.062      2.654    0.008      41697.849     278014.424 \n-----------------------------------------------------------------------------------------------------------------\n```\n\n\n:::\n:::\n\n\n\n\n\n# Model Selection\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmetric <- compare_performance(condo_mlr, \n                              condo_fw_mlr$model, \n                              condo_bw_mlr$model, \n                              condo_sb_mlr$model)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSome of the nested models seem to be identical\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmetric$Name <- gsub(\".*\\\\\\\\[a-zA-Z0-9_]+\\\\\\\\,\\\\\\\\model\\\\\\\\.*\",\"\\\\1\", metric$Name)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#plot(metric)\n```\n:::\n\n\n\n\n\n# Checking for Multicollinearity\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_collinearity(condo_sb_mlr$model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Check for Multicollinearity\n\nLow Correlation\n\n                 Term  VIF   VIF 95% CI Increased SE Tolerance Tolerance 95% CI\n             AREA_SQM 1.15 [1.09, 1.23]         1.07      0.87     [0.81, 0.92]\n             PROX_CBD 1.57 [1.47, 1.69]         1.25      0.64     [0.59, 0.68]\n            PROX_PARK 1.21 [1.15, 1.29]         1.10      0.83     [0.77, 0.87]\n             FREEHOLD 1.44 [1.36, 1.55]         1.20      0.69     [0.65, 0.74]\n                  AGE 1.41 [1.33, 1.52]         1.19      0.71     [0.66, 0.75]\n     PROX_ELDERLYCARE 1.52 [1.42, 1.63]         1.23      0.66     [0.61, 0.70]\n   PROX_SHOPPING_MALL 1.48 [1.39, 1.60]         1.22      0.67     [0.63, 0.72]\n PROX_URA_GROWTH_AREA 1.33 [1.26, 1.43]         1.15      0.75     [0.70, 0.80]\n             PROX_MRT 1.91 [1.78, 2.07]         1.38      0.52     [0.48, 0.56]\n        PROX_BUS_STOP 2.85 [2.62, 3.10]         1.69      0.35     [0.32, 0.38]\n      FAMILY_FRIENDLY 1.38 [1.30, 1.48]         1.17      0.72     [0.67, 0.77]\n          NO_Of_UNITS 1.45 [1.36, 1.56]         1.20      0.69     [0.64, 0.73]\n       PROX_CHILDCARE 3.26 [3.00, 3.56]         1.81      0.31     [0.28, 0.33]\n     PROX_PRIMARY_SCH 2.21 [2.05, 2.40]         1.49      0.45     [0.42, 0.49]\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(check_collinearity(condo_sb_mlr$model)) + \n  theme(axis.text.x = element_text(\n    angle = 45, hjust = 1\n  ))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nVariable `Component` is not in your data frame :/\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](InClassEx11_files/figure-html/unnamed-chunk-13-1.png){width=1152}\n:::\n:::\n\n\n\n\n\n# Linearity Assumption Test\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#out <- plot(check_model(condo_sb_mlr$model, panel=FALSE))\n\n#out[[2]]\n```\n:::\n\n\n\n\n\n# Checking for outliers\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#plot(check_outliers(condo_sb_mlr$model, \n                    #method = \"cook\"))\n```\n:::\n",
    "supporting": [
      "InClassEx11_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}