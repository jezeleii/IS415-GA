{
  "hash": "c2c683eb3d453c4cc78e80529ffa1b0d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"In-class 10\"\ndate: \"October 21, 2024\"\ndate-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  freeze: true\n---\n\n\n\n\n\n# 1.0 Overview\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(spdep, sp,tmap, sf,ClustGeo, cluster,factoextra, NbClust, tidyverse, GGally)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nshan_sf <- read_rds(\"data/rds/shan_sf.rds\")\nshan_ict <- read_rds(\"data/rds/shan_ict.rds\")\nshan_sf_cluster <- read_rds(\"data/rds/shan_sf_cluster.rds\")\n```\n:::\n\n\n\n\n\n# 2.0 Conventional Hierarchal Clustering\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nproxmat <- dist(shan_ict, method = \"euclidean\")\nhclust_ward <- hclust(proxmat, method=\"ward.D\")\ngroups <- as.factor(cutree(hclust_ward, k = 6))\n```\n:::\n\n\n\n\n\n-   proxmat - calculates proximity metrics\n\n-   [methods](https://www.datacamp.com/tutorial/hierarchical-clustering-R) to do agglomoration:\n\n-   will not understand the argument k if you do not return the hclust() function\n\n## Pivot to Determining Optimal Clusters\n\n1.  k.max == 10 ? Is not the same as K or clustering. Is not hierarchal clustering, but is the K of the graphical Plot to Compare Results.\n2.  You don't stop at one even if it is the highest; minimum 3. in the context of the the picture (hands-on 9; it is 6)\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshan_sf_cluster <- cbind(shan_sf, as.matrix(groups)) %>% \n  rename(`CLUSTER` = `as.matrix.groups.`) %>% \n  select(-c(3:4, 7:9)) %>% \n  rename(TS = TS.x)\n```\n:::\n\n\n\n\n\n-   this is an append function, as opposed to a left_join\n\n-   an alternative that can work is to use datatable or tibble (in place of shan_sf)\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqtm(shan_sf_cluster, \"CLUSTER\")\n```\n\n::: {.cell-output-display}\n![](InClassEx10_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(hclust_ward, cex = 0.6)\nrect.hclust(hclust_ward, k = 6, border = 2:5)\n```\n\n::: {.cell-output-display}\n![](InClassEx10_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\n\n-   When clustering; need to consider the spatial relationship of the neighbours ; consider the attribute value but also consider the geographical arrangement of the study area\n\nWhat would be interesting is to produce the cluster but consider geographical homogeneity. -\\> Spatially Constrained Clustering.\n\n# 3.0 Spatially Constrained Clustering\n\nMethods : SKATER, REDCAP, ClustGeo\n\n-   SKATER - Hard Classification\n\n-   ClustGeo - Soft Classification\n\n## 3.1 SKATER\n\nUsing Network Graph Methods,\n\n![](images/Screenshot%202024-10-21%20at%209.22.49%20AM.png)\n\n1.  Represent area by a node, and edges represent connections between areas, forming a network. You must always start with a network\n\n<!-- -->\n\n2.  Define Edge Cost (Pick up minimum Distance)\n3.  Generates only one spinning Tree at the end of the day (purely distance based) - Minimum Spanning Tree\n\nSlide: A heuristic for fast tree partitioning\n\n4.  Add an Attribute Value\n\nSKATER METHOD\n\n4.  Use poly2nb to find nearest neighbour. Do not need to change it to sp, because the recent versions of spdep, they can accept sf\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshan.nb <- poly2nb(shan_sf)\nsummary(shan.nb)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNeighbour list object:\nNumber of regions: 55 \nNumber of nonzero links: 264 \nPercentage nonzero weights: 8.727273 \nAverage number of links: 4.8 \nLink number distribution:\n\n 2  3  4  5  6  7  8  9 \n 5  9  7 21  4  3  5  1 \n5 least connected regions:\n3 5 7 9 47 with 2 links\n1 most connected region:\n8 with 9 links\n```\n\n\n:::\n:::\n\n\n\n\n\n2.  Visualising the neighbours\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(shan_sf), \n     border=grey(.5))\npts <- st_coordinates(st_centroid(shan_sf))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: st_centroid assumes attributes are constant over geometries\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(shan.nb, \n     pts, \n     col=\"blue\", \n     add=TRUE)\n```\n\n::: {.cell-output-display}\n![](InClassEx10_files/figure-html/unnamed-chunk-8-1.png){width=1152}\n:::\n:::\n\n\n\n\n\n-   Useful to explain the construction of the graph. But for the app, you can ignore because it is not of interest to the end user\n\n3.  Computing Minimum Spanning Tree\n\n-   a few processes can be considered\n\n    3.1 considering least cost\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlcosts <- nbcosts(shan.nb, shan_ict)\nlcosts\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n[1] 263.3710 144.0247 430.6407 237.7849\n\n[[2]]\n[1] 257.3161 302.5179 204.3295\n\n[[3]]\n[1] 257.3161 432.1653\n\n[[4]]\n[1] 181.96406  94.61225 138.12050\n\n[[5]]\n[1] 263.3710 674.0112\n\n[[6]]\n[1] 302.51785 181.96406 140.01101  95.66782 252.26066\n\n[[7]]\n[1]  94.61225 139.31874\n\n[[8]]\n[1] 204.32952 432.16535 140.01101  90.82891 186.29066 625.18712 249.35081\n[8] 274.91604 304.96838\n\n[[9]]\n[1]  90.82891 157.04230\n\n[[10]]\n[1] 144.0247 186.2907 157.0423 163.9574 347.8594\n\n[[11]]\n[1] 592.9074 704.8697 238.6706\n\n[[12]]\n[1] 522.96309  78.78999 157.48857 255.83275  59.69478\n\n[[13]]\n[1] 374.50873 131.67061 178.09554  92.79567 202.99615 174.67678 110.55197\n\n[[14]]\n[1] 374.5087 462.4194 329.2948 531.0802 388.7339\n\n[[15]]\n[1] 592.9074 580.3811 310.6081 229.3789 204.5401 392.4857 361.8268\n\n[[16]]\n[1] 131.6706 200.3180 150.9805 119.8699 236.7088\n\n[[17]]\n[1] 466.3647 177.3379 137.7942 109.0851\n\n[[18]]\n[1] 625.1871 522.9631 423.7787 379.3792 352.0653\n\n[[19]]\n[1] 466.36472 290.86435 365.88437  79.41836 170.63913 646.66493 429.84475\n\n[[20]]\n[1] 178.09554 200.31803  94.98486\n\n[[21]]\n[1] 203.0285 506.2994 201.6522 308.1380 585.6178 242.7823\n\n[[22]]\n[1] 677.0951 444.0441 432.1012\n\n[[23]]\n[1] 331.4262 316.3031 264.6500\n\n[[24]]\n[1] 203.0285 113.8092 574.4029 531.3600 445.4062\n\n[[25]]\n[1] 249.3508 163.9574 177.3379 423.7787 290.8643 229.4466 195.1768 194.4793\n\n[[26]]\n[1] 150.9805 677.0951 356.8492 140.9539 383.7214\n\n[[27]]\n[1] 331.42618  57.60801  78.29342 187.40057 347.14183\n\n[[28]]\n[1]  78.78999  92.79567 462.41938 273.02385  94.23028 128.20940\n\n[[29]]\n[1] 580.3811 635.9204 521.8866 331.6720\n\n[[30]]\n[1] 506.29940 316.30314  57.60801 108.37735 364.76893\n\n[[31]]\n[1] 365.8844 229.4466 448.5823 240.9555\n\n[[32]]\n[1] 444.0441 356.8492 408.0340 221.4761 285.5647\n\n[[33]]\n[1] 704.8697 310.6081 635.9204\n\n[[34]]\n[1] 202.9962 119.8699 201.6522 113.8092 140.9539 442.8082 158.9048 212.5962\n\n[[35]]\n[1] 274.91604 157.48857 379.37916  91.65458 513.76415 124.74445\n\n[[36]]\n[1] 138.12050  95.66782 139.31874 225.80242 325.09619\n\n[[37]]\n[1] 329.29477  91.65458 225.80242 528.14240 158.84853\n\n[[38]]\n[1] 574.4029 408.0340 202.4500 146.6666 315.5755\n\n[[39]]\n[1] 229.37894  79.41836 276.19175 162.80878 584.63341\n\n[[40]]\n[1] 204.5401 521.8866 276.1918 271.3445\n\n[[41]]\n[1] 170.63913  78.29342 331.67199 162.80878 271.34451 412.22167\n\n[[42]]\n[1] 238.6706 392.4857 721.8615\n\n[[43]]\n[1] 531.3600 383.7214 221.4761 442.8082 202.4500\n\n[[44]]\n[1] 174.67678 531.08019 236.70878  94.98486\n\n[[45]]\n[1] 308.1380 158.9048 146.6157 146.7889 127.4220\n\n[[46]]\n[1] 252.2607 304.9684 513.7642 325.0962 528.1424\n\n[[47]]\n[1] 264.6500 187.4006\n\n[[48]]\n[1] 255.83275 137.79420 352.06533 195.17677 273.02385 146.61572 278.95182\n[8]  47.79331\n\n[[49]]\n[1]  59.69478 388.73386  94.23028 124.74445 158.84853\n\n[[50]]\n[1] 430.6407 674.0112 361.8268 646.6649 448.5823 584.6334 721.8615 210.4849\n\n[[51]]\n[1] 585.6178 445.4062 108.3773 146.6666\n\n[[52]]\n[1] 110.5520 128.2094 212.5962 146.7889 278.9518\n\n[[53]]\n[1] 432.1012 285.5647 315.5755\n\n[[54]]\n[1] 109.08506 429.84475 242.78233 347.14183 364.76893 412.22167 127.42203\n[8]  47.79331\n\n[[55]]\n[1] 237.7849 347.8594 194.4793 240.9555 210.4849\n\nattr(,\"call\")\nnbcosts(nb = shan.nb, data = shan_ict)\nattr(,\"class\")\n[1] \"nbdist\"\n```\n\n\n:::\n:::\n\n\n\n\n\n3.2 Incorporating costs into a weight object\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshan.w <- nb2listw(shan.nb, \n                   lcosts, \n                   style=\"B\")\nsummary(shan.w)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 55 \nNumber of nonzero links: 264 \nPercentage nonzero weights: 8.727273 \nAverage number of links: 4.8 \nLink number distribution:\n\n 2  3  4  5  6  7  8  9 \n 5  9  7 21  4  3  5  1 \n5 least connected regions:\n3 5 7 9 47 with 2 links\n1 most connected region:\n8 with 9 links\n\nWeights style: B \nWeights constants summary:\n   n   nn       S0       S1        S2\nB 55 3025 76267.65 58260785 522016004\n```\n\n\n:::\n:::\n\n\n\n\n\n-   needs to be binary - excludes or includes neigbours, B should be an argument and shouldn't be exposed as a parameter\n\n3.3 Computing MST\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshan.mst <- mstree(shan.w)\nshan.mst\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      [,1] [,2]      [,3]\n [1,]   34   24 113.80917\n [2,]   34   16 119.86993\n [3,]   16   13 131.67061\n [4,]   13   28  92.79567\n [5,]   28   12  78.78999\n [6,]   12   49  59.69478\n [7,]   13   52 110.55197\n [8,]   49   35 124.74445\n [9,]   35   37  91.65458\n[10,]   34   26 140.95392\n[11,]   52   45 146.78891\n[12,]   45   54 127.42203\n[13,]   54   48  47.79331\n[14,]   54   17 109.08506\n[15,]   13   44 174.67678\n[16,]   44   20  94.98486\n[17,]   17   25 177.33790\n[18,]   25   10 163.95741\n[19,]   10    1 144.02475\n[20,]   10    9 157.04230\n[21,]    9    8  90.82891\n[22,]    8    6 140.01101\n[23,]    6   36  95.66782\n[24,]   36    4 138.12050\n[25,]    4    7  94.61225\n[26,]   25   55 194.47928\n[27,]   34   21 201.65224\n[28,]    8    2 204.32952\n[29,]   55   50 210.48485\n[30,]   25   31 229.44658\n[31,]    6   46 252.26066\n[32,]    2    3 257.31610\n[33,]    1    5 263.37099\n[34,]   25   19 290.86435\n[35,]   19   39  79.41836\n[36,]   39   41 162.80878\n[37,]   41   27  78.29342\n[38,]   27   30  57.60801\n[39,]   30   51 108.37735\n[40,]   51   38 146.66661\n[41,]   27   47 187.40057\n[42,]   38   43 202.45004\n[43,]   43   32 221.47613\n[44,]   39   15 229.37894\n[45,]   15   40 204.54010\n[46,]   47   23 264.64997\n[47,]   32   53 285.56475\n[48,]   15   33 310.60810\n[49,]   37   14 329.29477\n[50,]   41   29 331.67199\n[51,]   48   18 352.06533\n[52,]   15   42 392.48568\n[53,]   42   11 238.67060\n[54,]   53   22 432.10118\nattr(,\"class\")\n[1] \"mst\"    \"matrix\"\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(shan_sf), \n     border=gray(.5))\nplot.mst(shan.mst, \n         pts, col=\"blue\", \n         cex.lab=0.7, \n         cex.circles=0.005, \n         add=TRUE)\n```\n\n::: {.cell-output-display}\n![](InClassEx10_files/figure-html/unnamed-chunk-12-1.png){width=1152}\n:::\n:::\n\n\n\n\n\n4.  Skater Tree\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nskater.clust6 <- skater(edges = shan.mst[,1:2], \n                        data = shan_ict, \n                        method=\"euclidean\", \n                        ncuts = 5)\nskater.clust6\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$groups\n [1] 3 3 6 3 3 3 3 3 3 3 2 1 1 1 2 1 1 1 2 4 1 2 5 1 1 1 2 1 2 2 1 2 2 1 1 3 1 2\n[39] 2 2 2 2 2 4 1 3 2 1 1 1 2 1 2 1 1\n\n$edges.groups\n$edges.groups[[1]]\n$edges.groups[[1]]$node\n [1] 13 48 45 55 52 37 34 16 25 54 35 17 28 12 49 18 50 14 21 31 24 26\n\n$edges.groups[[1]]$edge\n      [,1] [,2]      [,3]\n [1,]   48   18 365.12877\n [2,]   55   50 289.28639\n [3,]   45   54 279.32355\n [4,]   37   14 276.76268\n [5,]   34   21 269.69073\n [6,]   34   16 219.58865\n [7,]   52   45 219.06155\n [8,]   25   31 218.04887\n [9,]   16   13 204.70581\n[10,]   13   28 198.11085\n[11,]   25   55 188.11124\n[12,]   34   24 179.51227\n[13,]   54   48 139.09943\n[14,]   13   52 119.22552\n[15,]   34   26  93.16661\n[16,]   28   12  88.29377\n[17,]   54   17  64.59928\n[18,]   35   37  47.73326\n[19,]   17   25  45.04693\n[20,]   12   49  12.32367\n[21,]   49   35 -11.64538\n\n$edges.groups[[1]]$ssw\n[1] 3422.74\n\n\n$edges.groups[[2]]\n$edges.groups[[2]]$node\n [1] 47 27 53 38 42 15 41 51 43 32 30 19 39 22 11 33 29 40\n\n$edges.groups[[2]]$edge\n      [,1] [,2]       [,3]\n [1,]   53   22 386.684498\n [2,]   15   33 385.897990\n [3,]   42   11 366.675375\n [4,]   38   43 346.581522\n [5,]   41   29 338.133590\n [6,]   51   38 290.135624\n [7,]   15   42 288.993876\n [8,]   27   47 261.376960\n [9,]   15   40 261.319724\n[10,]   43   32 260.053478\n[11,]   32   53 209.411293\n[12,]   30   51 156.366830\n[13,]   19   39 118.358401\n[14,]   27   30  52.573252\n[15,]   39   15  41.915549\n[16,]   39   41   6.497483\n[17,]   41   27  -8.505392\n\n$edges.groups[[2]]$ssw\n[1] 3759.364\n\n\n$edges.groups[[3]]\n$edges.groups[[3]]$node\n [1]  2  6  8  1 36  4 10  9 46  5  7\n\n$edges.groups[[3]]$edge\n      [,1] [,2]        [,3]\n [1,]    6   46 355.0727573\n [2,]    1    5 212.8821329\n [3,]    8    2 196.4900911\n [4,]   36    4 163.5355565\n [5,]    4    7 121.5608451\n [6,]    6   36 100.0767619\n [7,]    8    6  43.9202323\n [8,]   10    9  24.8416921\n [9,]   10    1  24.1890957\n[10,]    9    8  -0.6180172\n\n$edges.groups[[3]]$ssw\n[1] 1458.074\n\n\n$edges.groups[[4]]\n$edges.groups[[4]]$node\n[1] 44 20\n\n$edges.groups[[4]]$edge\n     [,1] [,2]     [,3]\n[1,]   44   20 94.98486\n\n$edges.groups[[4]]$ssw\n[1] 94.98486\n\n\n$edges.groups[[5]]\n$edges.groups[[5]]$node\n[1] 23\n\n$edges.groups[[5]]$edge\n     [,1] [,2] [,3]\n\n$edges.groups[[5]]$ssw\n[1] 0\n\n\n$edges.groups[[6]]\n$edges.groups[[6]]$node\n[1] 3\n\n$edges.groups[[6]]$edge\n     [,1] [,2] [,3]\n\n$edges.groups[[6]]$ssw\n[1] 0\n\n\n\n$not.prune\nNULL\n\n$candidates\n[1] 1 2 3 4 5 6\n\n$ssto\n[1] 12612.52\n\n$ssw\n[1] 12612.515 10977.044  9961.641  9540.422  9122.654  8735.162\n\n$crit\n[1]   1 Inf\n\n$vec.crit\n [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[39] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n\nattr(,\"class\")\n[1] \"skater\"\n```\n\n\n:::\n:::\n\n\n\n\n\n-   n is always k - 1 (because n starts from 0)\n\n-   If you do not want to confuse your user; create a parameter where n is what the user places; and the backend processes it as n - 1\n\n-   though they have neighbours, in terms of their attribute neighbours they are far from it\n\nCode chunk to plot the skater tree\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(shan_sf), \n     border=gray(.5))\nplot(skater.clust6, \n     pts, \n     cex.lab=0.7, \n     groups.colors=c(\"red\", \"green\", \"blue\", \"brown\", \"pink\"), \n     cex.circles=0.005,\n     add=TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1], coords[id2,\n: \"add\" is not a graphical parameter\nWarning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1], coords[id2,\n: \"add\" is not a graphical parameter\nWarning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1], coords[id2,\n: \"add\" is not a graphical parameter\nWarning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1], coords[id2,\n: \"add\" is not a graphical parameter\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](InClassEx10_files/figure-html/unnamed-chunk-14-1.png){width=1152}\n:::\n:::\n\n\n\n\n\n6.  Visualizing the clusters in a chorpleth Map\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngroups_mat <- as.matrix(skater.clust6$groups)\nshan_sf_spatialcluster <- cbind(shan_sf_cluster, as.factor(groups_mat)) %>% \n  rename(`skater_CLUSTER` = `as.factor.groups_mat.`)\nqtm(shan_sf_spatialcluster, \"skater_CLUSTER\")\n```\n\n::: {.cell-output-display}\n![](InClassEx10_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n\n\n-   we use as factor, instead of as character, because for numerical value, it will be automatically organized.\n\n    -   if we are using month; be careful of using ascending order\n\n    -   function to convert group object into a factor (second line) ; what we really want is the group field (groups)\n\nConclusion: Useful, considered as Hard Classification as it is using nearest neighbour. All classification is based on a minimum spanning tree.\n\n## 3.2 ClustGeo Method\n\nSoft Classification method, allowing us to decide how many proportion of the attribute we want to use and how many proportion of spatial we want to use (?)\n\n-   At what cutoff point you want to have a spatially constrained analysis. Interpretation is eyebaleld at the intersection. Once detected, we read downward and take the cutoff value. If the user wants to emphasise more on the spatial interaction (needs to increase in the D3)\n\n1.  Computing Spatial Distance Matrix\n\n2.  The Cluster Graphs\n\n3.  The Code\n\n4.  Saving clustGeoOutput\n\n5.  Computing Spatial Distance Matrix\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndist <- st_distance(shan_sf, shan_sf)\ndistmat <- as.dist(dist)\ndistmat\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            1          2          3          4          5          6          7\n2  195556.505                                                                  \n3  129387.742      0.000                                                       \n4  263507.011  20287.139  35045.819                                            \n5       0.000 235922.248 170256.882 303641.675                                 \n6  206100.802      0.000   5918.623      0.000 246913.514                      \n7  323534.459  89844.904 104686.167      0.000 366407.917  62016.362           \n8   69522.935      0.000      0.000  54865.392 114370.764      0.000 113520.171\n9   23022.686  90556.539  24837.389 158164.723  49220.458 100667.381 217177.595\n10      0.000 125878.894  61496.303 193218.233  35690.821 135852.908 246848.941\n11  86379.395 304705.838 243351.150 369959.441  50976.372 313290.202 417813.257\n12 169809.951  66109.333  67984.860 104005.110 216670.451  57512.865 129799.472\n13 253312.412  95697.255 110713.509  80265.740 299034.814  80291.953  73365.690\n14 271081.363  82018.859  97252.671  38887.572 317186.716  65295.782  24164.519\n15  54016.405 257508.461 195772.184 323183.597  35052.355 266543.534 372976.783\n16 285264.789 181001.427 194500.970 154388.211 329118.347 167920.605 139912.573\n17  95471.826 168583.147 125298.657 221420.369 115008.528 169057.458 254278.121\n18 100263.905  61048.429  34734.035 116432.966 148209.911  61376.634 162462.775\n19  56159.890 185884.336 129195.094 249676.927  59292.850 193077.470 296950.715\n20 300991.436 145702.569 160931.848 109987.964 349107.582 128799.835  96151.976\n21 187467.334 197890.954 180793.621 225025.234 207571.240 189124.671 232754.070\n22 346871.303 277251.030 285386.281 268263.171 379768.207 264791.943 255124.680\n23 200861.675 270885.571 239361.421 312273.553 191002.354 267251.608 328350.762\n24 238059.685 233701.918 218542.382 260252.959 263030.313 225446.129 264028.091\n25  26041.159 115054.691  60636.027 179571.017  67317.991 122902.102 226884.133\n26 308358.355 233030.728 242922.008 215969.198 343590.934 219146.677 202619.694\n27 155844.022 271643.367 224433.981 325475.131 146153.005 274268.249 351356.260\n28 215441.818  76693.744  91669.580  64814.007 263056.133  61551.509  68332.880\n29 153710.825 320261.543 267478.292 379988.297 124408.683 324643.830 415583.879\n30 161431.340 223082.170 192124.994 268058.340 157252.237 220518.884 289883.659\n31  19075.492 184510.055 122148.576 250903.422  32615.481 194106.473 303810.701\n32 338736.603 277547.243 283513.348 272384.959 369756.965 265419.379 259397.390\n33 146179.586 343224.804 286891.346 405219.593 111473.353 349111.896 444127.535\n34 226142.268 177565.034 182866.086 176977.401 261405.930 165257.485 168069.584\n35 163288.621  27830.180  27714.596  39674.472 207752.013  18086.000  62189.187\n36 238257.757  16287.476  30940.939      0.000 280781.462      0.000      0.000\n37 258443.625  52324.676  67434.780  12565.296 303532.869  34676.934   1708.688\n38 310443.752 304907.121 295917.034 323831.359 322064.103 295060.668 318966.394\n39  59815.622 244039.406 183495.192 309163.893  52450.220 252494.485 356827.842\n40 137576.151 299723.401 249154.788 357747.584 115224.161 303248.846 391268.599\n41 140386.923 270807.815 223402.858 327471.691 125474.227 273566.667 360186.149\n42  36623.068 269890.893 205947.553 336462.106    684.660 279578.115 387995.580\n43 293579.127 253773.622 257196.660 257259.479 320401.835 241956.554 246513.434\n44 284036.690 118379.917 133610.408  65160.921 332148.697 101862.990  50376.780\n45 169757.201 161351.489 142270.891 198015.943 202155.178 155176.962 212408.422\n46 203107.401   7348.896  20334.461   7930.656 247622.558      0.000  20143.853\n47 205997.158 296139.668 257843.898 344937.638 190739.504 295423.885 366865.511\n48 129325.816 120151.016  93546.254 160082.228 174418.520 115048.928 172421.057\n49 189677.309  58462.352  68420.604  60286.544 236878.351  47868.999  62561.579\n50      0.000 219743.016 153859.023 287498.759      0.000 229997.198 345509.329\n51 238175.538 250932.863 232195.418 283133.329 249718.983 244116.083 291525.501\n52 207050.341 150928.728 152462.426 164615.483 243750.148 140164.178 161766.535\n53 364419.326 333951.035 333052.730 341093.856 378319.613 322743.462 328011.755\n54 108778.098 190392.856 158772.456 230605.090 109101.542 187038.310 248355.010\n55      0.000 179178.881 114134.538 246614.680  18145.243 189194.177 303417.068\n            8          9         10         11         12         13         14\n2                                                                              \n3                                                                              \n4                                                                              \n5                                                                              \n6                                                                              \n7                                                                              \n8                                                                              \n9       0.000                                                                  \n10      0.000      0.000                                                       \n11 175320.795 173212.023 116207.683                                            \n12  19258.901  76755.290  86042.045 230556.039                                 \n13  76741.564 163497.805 169554.442 302459.474  24821.510                      \n14  72791.804 167722.650 189805.990 352908.098  59860.837      0.000           \n15 127836.395 127318.108  73206.058      0.000 188909.527 263692.304 309507.790\n16 147131.153 205247.726 201893.922 326060.272  59133.110      0.000  73449.151\n17  60943.072  88002.449  47262.179  94474.936  61764.462 122173.412 183868.288\n18      0.000  25350.746  16943.002 182787.768      0.000  76461.055 100592.314\n19  61392.064  76323.846  35892.441  52425.182 114397.292 191975.262 233357.198\n20 130809.241 208788.342 217363.475 357462.076  65676.449      0.000  22456.174\n21 130031.042 161755.314 128777.451 176635.114  60507.647  69837.820 150220.997\n22 236938.078 286141.113 269211.866 351246.195 142949.414  90227.682 172872.361\n23 177680.902 207807.558 167250.840 134857.318 141508.495 167915.044 247633.487\n24 168774.977 200499.099 169883.097 227146.230  96168.166  93458.470 179537.644\n25      0.000  22243.772      0.000  98295.041  39244.113 120134.519 161050.913\n26 194667.840 245235.206 229378.107 321225.185 100927.717  38077.228 122131.998\n27 158092.508 178939.909 139166.450  96980.140 159208.239 204142.982 275608.822\n28  51088.836 119515.171 132399.342 273369.585      0.000      0.000      0.000\n29 199971.871 214371.495 165320.168  24145.516 223046.171 279693.091 345753.566\n30 132246.631 164123.403 125800.409 111564.212  98595.073 142762.901 213150.606\n31  54427.919  59130.535  17411.578  49699.980 132021.856 214291.372 244370.721\n32 234997.676 282169.074 262552.405 335900.573 140851.199  93919.413 176420.525\n33 218404.140 225277.471 171424.519      0.000 251688.292 311140.002 375404.019\n34 135055.043 171977.382 149125.676 245775.738  47718.421      0.000  82051.347\n35      0.000  57498.939  83302.701 252124.698      0.000  23306.582   8898.476\n36  28059.016 131916.748 163665.969 338647.153  67833.099  63593.876  24694.074\n37  54304.353 153326.666 178992.549 347137.118  60456.115  17787.982      0.000\n38 248035.930 279686.832 247884.342 273957.054 164271.288 144508.042 232803.986\n39 115121.934 119264.883  67566.417  31211.561 168622.877 241325.490 291247.975\n40 181526.031 195585.173 146862.747  36419.627 199001.491 253417.272 320275.237\n41 157001.423 177262.345 137606.320  63576.332 168035.655 222841.109 289203.825\n42 139770.820 127988.737  68755.193      0.000 206680.393 283714.108 325853.818\n43 208735.725 247092.921 221343.800 283290.577 115430.776  78095.134 161364.589\n44 104113.054 191095.191 200427.479 342467.482  48734.844      0.000      0.000\n45  93899.883 125172.546  97363.790 183922.200  27316.069  62414.561 133276.273\n46      0.000  97367.068 125599.346 298943.942  31696.588  47458.150  25900.228\n47 194315.118 220682.275 180631.221 123043.209 176240.242 211489.350 288259.336\n48  40286.821  71645.864  47197.328 171020.080      0.000  27439.837  93784.752\n49  24400.983  91176.153 107084.057 269523.649      0.000  15778.131      0.000\n50  92350.383  71036.705  11622.534  37842.609 176923.960 253267.419 290153.337\n51 178121.527 210248.552 176300.297 206410.180 114676.272 123955.574 208242.120\n52 103772.692 150364.110 129276.805 232518.473   9924.623      0.000  76507.724\n53 284464.119 322816.681 295429.670 325019.850 192995.311 161422.735 244990.784\n54  94110.951 119059.122  78962.685  82702.314  59872.389  99870.382 170415.727\n55  51290.239  34881.648      0.000  88772.043 141604.664 224443.761 247667.854\n           15         16         17         18         19         20         21\n2                                                                              \n3                                                                              \n4                                                                              \n5                                                                              \n6                                                                              \n7                                                                              \n8                                                                              \n9                                                                              \n10                                                                             \n11                                                                             \n12                                                                             \n13                                                                             \n14                                                                             \n15                                                                             \n16 286743.896                                                                  \n17  55732.556 146051.070                                                       \n18 138013.530 108961.702  38321.692                                            \n19   9953.833 219564.130      0.000  61888.281                                 \n20 318708.836      0.000 177042.592 122889.257 245797.451                      \n21 131924.670  81716.806  27872.779  69178.400  79746.979 112269.006           \n22 301783.472  38986.249 185712.357 184737.030 251910.793  89571.634  93205.892\n23  83459.767 178904.732  71100.239 137469.536  45924.303 209460.437  15971.532\n24 176512.420 100634.425  73368.887 106466.043 127382.984 131065.752      0.000\n25  51796.921 150616.681      0.000      0.000      0.000 171864.246  59534.970\n26 274673.067      0.000 149954.796 143832.727 223319.208  37046.211  59260.377\n27  45205.840 217778.804  48744.354 139874.443   1007.634 249086.524  50859.614\n28 234620.624  23743.654  93306.250  41359.924 162103.353  28976.742  48550.840\n29      0.000 296684.458  89204.612 189821.842  35147.961 329682.929 135492.326\n30  60002.954 156410.476  25164.078  89848.488  14024.033 186966.473      0.000\n31   3273.070 244243.532  30426.367  70720.773      0.000 265148.939 124334.456\n32 284286.622  54288.243 176052.153 180683.527 239127.824  94200.785  83845.774\n33      0.000 328847.700 114022.872 214872.141  62357.918 361771.160 169464.506\n34 202405.645      0.000  69029.846  70925.251 145941.732  25967.588      0.000\n35 206902.736 108339.459  97150.338      0.000 131024.997  72482.742 121963.238\n36 292422.633 140186.697 185541.367  82804.129 217723.180  96090.992 190810.138\n37 302844.670 109203.536 183367.233  92711.798 226574.115  60470.353 169415.052\n38 222499.815 124429.217 149617.042 183481.271 179176.711 160260.947  66345.300\n39      0.000 265532.486  34479.418 122282.314      0.000 296313.408 109449.369\n40      0.000 269855.975  70226.672 168377.604  13221.297 302757.851 109598.400\n41  20257.687 240272.364  46532.820 139052.487      0.000 273170.669  83127.720\n42      0.000 310029.817  82437.185 153598.888  27910.843 338018.468 171814.436\n43 231750.599  53508.849 128945.341 146315.715 183807.805  85553.918  40404.674\n44 303248.084      0.000 163054.881 105938.659 229508.771      0.000 117481.005\n45 143641.853  81129.916   8591.072  30706.586  85234.441 113184.562      0.000\n46 253047.507 137449.905 147298.301  42752.576 177875.163  89233.741 162626.986\n47  76179.452 223535.788  89770.573 165022.484  50704.136 254088.519  56678.100\n48 132269.455  54561.836      0.000      0.000  64067.821  82450.454  27306.912\n49 225575.753  93836.721 106752.454  16766.049 149329.065  62478.632 113903.139\n50      0.000 279612.631  53522.022 116632.142      0.000 307701.276 143972.927\n51 154619.356 131136.524  77449.876 121307.323 108526.604 161422.312      0.000\n52 192861.022  12265.196  54294.794  49021.534 129699.659  44113.815   6823.544\n53 274943.790 116554.761 199908.587 222478.778 234116.468 162372.855 113237.596\n54  41609.200 116394.326      0.000  58210.284      0.000 149143.417      0.000\n55  42026.540 255059.017  55111.529  74436.367  17333.439 274000.806 148722.005\n           22         23         24         25         26         27         28\n2                                                                              \n3                                                                              \n4                                                                              \n5                                                                              \n6                                                                              \n7                                                                              \n8                                                                              \n9                                                                              \n10                                                                             \n11                                                                             \n12                                                                             \n13                                                                             \n14                                                                             \n15                                                                             \n16                                                                             \n17                                                                             \n18                                                                             \n19                                                                             \n20                                                                             \n21                                                                             \n22                                                                             \n23 169673.189                                                                  \n24  70699.532  47406.646                                                       \n25 203711.257 104152.491  97909.545                                            \n26      0.000 148926.851  54743.696 165849.744                                 \n27 213463.438      0.000  89709.163  75860.932 191247.775                      \n28 115660.539 145601.524  81382.530  90348.276  72517.463 176102.855           \n29 299766.056  76334.894 175925.551 115037.581 277255.534  33207.483 250902.425\n30 149070.094      0.000  25953.669  57663.181 127534.130      0.000 113789.285\n31 293330.174 133452.322 178175.678      0.000 257001.417  90406.278 184108.828\n32      0.000 142831.466  33640.177 195363.494      0.000 190758.261 114664.715\n33 336028.146 112800.617 211068.537 136438.634 311361.367  71441.170 282450.005\n34  26475.714  75441.994      0.000  83329.338      0.000 118029.451  16970.497\n35 205751.627 194859.948 157840.084  63354.834 160860.936 201996.065   4288.960\n36 251696.986 276387.576 226522.189 148802.619 200681.960 289282.043  46314.607\n37 208098.014 262669.230 202813.957 155820.538 158368.866 282302.722   4175.507\n38  35736.788  80900.402      0.000 175742.936  60025.272 128886.694 146379.816\n39 279039.163  59098.616 153758.237  37538.658 252196.448  22403.919 212012.869\n40 276586.490  53823.256 151399.780  96937.024 251377.330  15328.025 224573.492\n41 253448.297  34787.787 128440.482  74016.863 225749.554      0.000 194060.704\n42 347200.935 151965.444 227250.519  66410.626 313784.638 108917.695 253982.095\n43  14568.329  93843.504      0.000 151048.480      0.000 140088.193  90556.090\n44 122236.692 215706.503 143419.905 155279.706  69157.169 247803.233  14298.628\n45 116473.199  70818.630  32864.767  27123.931  79015.689  83152.630  33488.153\n46 235566.263 242309.130 198967.174 109361.127 187586.148 251853.426  29223.461\n47 212225.147      0.000  92554.244 121764.070 193833.083      0.000 186794.381\n48 132124.849  77804.189  63737.142      0.000  90774.721  84852.486      0.000\n49 188845.623 195289.089 150029.209  78092.739 144899.441 208572.815      0.000\n50 318554.171 134548.542 199395.883  32306.880 284471.830  89504.443 223550.876\n51  90554.623  21071.178      0.000 104471.663  83357.559  63699.799 107383.136\n52  71462.052  97438.692  41814.657  64825.750  30404.050 127906.111      0.000\n53      0.000 134160.494  34307.742 224013.045  63305.323 181687.904 171923.212\n54 146624.123  28479.224  27923.206  20184.852 111999.009      0.000  70948.098\n55 311837.843 159847.985 200228.148      0.000 273958.007 117314.838 189961.258\n           29         30         31         32         33         34         35\n2                                                                              \n3                                                                              \n4                                                                              \n5                                                                              \n6                                                                              \n7                                                                              \n8                                                                              \n9                                                                              \n10                                                                             \n11                                                                             \n12                                                                             \n13                                                                             \n14                                                                             \n15                                                                             \n16                                                                             \n17                                                                             \n18                                                                             \n19                                                                             \n20                                                                             \n21                                                                             \n22                                                                             \n23                                                                             \n24                                                                             \n25                                                                             \n26                                                                             \n27                                                                             \n28                                                                             \n29                                                                             \n30  63442.979                                                                  \n31  98903.717  92729.359                                                       \n32 272613.576 128643.087 283624.938                                            \n33      0.000  96071.092 101504.639 311977.885                                 \n34 204319.773  54190.231 174850.937  21775.586 238925.579                      \n35 255785.928 147721.613 138657.157 207557.988 282482.843 107558.930           \n36 344873.821 231853.593 221305.760 253783.217 371234.630 154161.769  13848.369\n37 344649.962 221748.266 235099.156 211216.500 373002.882 113868.068      0.000\n38 210829.613  68179.724 245997.343      0.000 250046.941  35019.713 231161.923\n39  13521.972  37246.683   2696.464 260141.508  41117.910 179870.442 191755.549\n40      0.000  36186.716  81007.403 254359.002   6889.527 178937.894 233250.183\n41      0.000  13196.585  79110.667 234261.722  37763.554 153543.832 202938.612\n42  66439.690 120189.371  16240.208 335900.892  48781.075 233963.260 222029.525\n43 225166.273  75856.151 235519.089      0.000 263093.927      0.000 186035.416\n44 322061.781 185441.682 248357.608 131237.411 353342.422  40807.441  45078.467\n45 155175.006  22914.075 115566.939 108574.163 186853.147      0.000  84880.469\n46 305442.382 196285.831 182788.529 238103.803 331398.854 138725.489      0.000\n47  56919.878   9198.532 143208.224 177145.542  95905.483 120367.533 222677.438\n48 151812.910  29079.430  89699.902 127416.080 182810.791  20852.433  43712.915\n49 267867.558 150400.574 160341.491 188735.686 295926.720  89092.659      0.000\n50  94428.403  97337.055      0.000 307598.589  93496.700 204097.484 183643.689\n51 149915.672      0.000 174128.118  55956.044 186687.158  23501.863 174761.923\n52 204348.300  65926.706 157384.229  69103.168 236109.237      0.000  82366.146\n53 258666.879 124789.006 302511.961      0.000 297394.265  67841.275 264296.156\n54  55740.365      0.000  39419.691 135336.403  87776.147  33940.005 115690.277\n55 133828.308 118611.247      0.000 303093.901 140256.228 191462.885 141156.114\n           36         37         38         39         40         41         42\n2                                                                              \n3                                                                              \n4                                                                              \n5                                                                              \n6                                                                              \n7                                                                              \n8                                                                              \n9                                                                              \n10                                                                             \n11                                                                             \n12                                                                             \n13                                                                             \n14                                                                             \n15                                                                             \n16                                                                             \n17                                                                             \n18                                                                             \n19                                                                             \n20                                                                             \n21                                                                             \n22                                                                             \n23                                                                             \n24                                                                             \n25                                                                             \n26                                                                             \n27                                                                             \n28                                                                             \n29                                                                             \n30                                                                             \n31                                                                             \n32                                                                             \n33                                                                             \n34                                                                             \n35                                                                             \n36                                                                             \n37      0.000                                                                  \n38 292796.216 262033.132                                                       \n39 277930.329 285933.283 198266.437                                            \n40 322275.806 320573.959 192377.211      0.000                                 \n41 291834.747 289554.579 172320.811      0.000      0.000                      \n42 306464.352 318383.184 285093.084  16326.464  66835.105  85417.567           \n43 232795.959 194136.688      0.000 208711.961 204269.623 184348.758 284185.134\n44  50984.811  23937.344 191175.415 280877.908 295879.190 265210.705 321785.748\n45 162233.622 146775.783 105304.002 122905.763 128840.878  98351.555 172253.091\n46      0.000      0.000 268494.879 238333.580 283210.869 253018.963 267495.569\n47 308651.712 299303.244 116214.777  52120.568  42324.552  19825.273 146427.184\n48 124910.268 107359.439 135858.697 109915.396 126039.549  95061.641 153308.247\n49  39972.046      0.000 218134.447 208215.867 244169.515 213296.453 241675.613\n50 260845.950 278849.699 260368.557      0.000  77029.698  75310.028      0.000\n51 248355.641 228404.868      0.000 131369.778 127538.947 107703.973 212823.532\n52 136404.086 102885.775 107196.369 172099.153 177902.608 147567.823 218458.652\n53 315775.248 277980.647      0.000 250358.448 243245.215 221894.763 341271.294\n54 194804.713 181452.643  99543.838  24012.774  29438.425      0.000  73080.059\n55 219087.619 236421.025 271230.783  35889.646 115413.103 109637.057  49078.246\n           43         44         45         46         47         48         49\n2                                                                              \n3                                                                              \n4                                                                              \n5                                                                              \n6                                                                              \n7                                                                              \n8                                                                              \n9                                                                              \n10                                                                             \n11                                                                             \n12                                                                             \n13                                                                             \n14                                                                             \n15                                                                             \n16                                                                             \n17                                                                             \n18                                                                             \n19                                                                             \n20                                                                             \n21                                                                             \n22                                                                             \n23                                                                             \n24                                                                             \n25                                                                             \n26                                                                             \n27                                                                             \n28                                                                             \n29                                                                             \n30                                                                             \n31                                                                             \n32                                                                             \n33                                                                             \n34                                                                             \n35                                                                             \n36                                                                             \n37                                                                             \n38                                                                             \n39                                                                             \n40                                                                             \n41                                                                             \n42                                                                             \n43                                                                             \n44 117459.147                                                                  \n45  68795.138 105082.383                                                       \n46 216210.182  54380.402 129406.561                                            \n47 134304.264 257958.687 100101.929 272129.659                                 \n48  95170.913  69383.140      0.000  90024.245 103809.173                      \n49 164718.269  35858.181  81670.355  21749.075 227338.872  44009.601           \n50 256983.422 291544.062 142673.963 224397.807 140177.948 122890.459 207183.117\n51  21690.397 173579.294  51662.562 217969.781  64431.054  69938.773 169999.413\n52  44084.518  41698.742      0.000 113710.328 138113.640      0.000  62757.414\n53   1753.424 200479.251 144614.077 296525.797 161160.760 171280.715 245036.492\n54  85445.746 142542.993      0.000 161541.116  38226.638      0.000 114028.271\n55 256558.082 257096.351 133759.089 182205.445 169812.337  99672.594 164860.216\n           50         51         52         53         54\n2                                                        \n3                                                        \n4                                                        \n5                                                        \n6                                                        \n7                                                        \n8                                                        \n9                                                        \n10                                                       \n11                                                       \n12                                                       \n13                                                       \n14                                                       \n15                                                       \n16                                                       \n17                                                       \n18                                                       \n19                                                       \n20                                                       \n21                                                       \n22                                                       \n23                                                       \n24                                                       \n25                                                       \n26                                                       \n27                                                       \n28                                                       \n29                                                       \n30                                                       \n31                                                       \n32                                                       \n33                                                       \n34                                                       \n35                                                       \n36                                                       \n37                                                       \n38                                                       \n39                                                       \n40                                                       \n41                                                       \n42                                                       \n43                                                       \n44                                                       \n45                                                       \n46                                                       \n47                                                       \n48                                                       \n49                                                       \n50                                                       \n51 187794.242                                            \n52 188300.401  63878.816                                 \n53 317236.639  40678.306 125620.201                      \n54  46163.695  27513.774  24024.975 152519.692           \n55      0.000 199446.230 172789.492 326159.319  65731.590\n```\n\n\n:::\n:::\n\n\n\n\n\n-   tibble data format, as.dist to make it into a matrix\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr <- choicealpha(proxmat, distmat, range.alpha= seq(0,1,0.1), \n                  K=6, graph=TRUE)\n```\n\n::: {.cell-output-display}\n![](InClassEx10_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](InClassEx10_files/figure-html/unnamed-chunk-17-2.png){width=672}\n:::\n:::\n\n\n\n\n\n-   allows us to see how we want to do the cut off\n\n-   proxmat - hierarchal clustering\n\n-   distmat - calculated based on the centroid\n\n-   alpha range - always 0 - 1.\n\n-   breakout (0.1) intervals\n\n2 graphs; usually refer to the 1st one  if you use the first, for explanation. useful for end user to decide the cutoff\n\n-   Use Raw (1st one) - reflects the true value\n\n-   2nd is standardized. Purpose: allow you to better understand if you want to compare line 1 and line 2  see the differences better ; allows you to see how the values change at the absolute point\n\n4.  Save clustGeoOutput\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclustG <- hclustgeo(proxmat, distmat, alpha=0.2)\ngroups <- as.factor(cutree(clustG, k=6))\nshan_sf_clustGeo <- cbind(shan_sf, as.matrix(groups)) %>% \n  rename(`clustGeo` = `as.matrix.groups.`)\n```\n:::\n\n\n\n\n\nExplanation:\n\n1.  For Users, have a UI for user to decide what value they want to use (slider input)  this is where you apply intercept.\n2.  Once you have this part, the interface should stop; after selecting value; it updates the backend; if not it keeps writing in and displaying out\n\nVisualizing the clustGeomap\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqtm(shan_sf_clustGeo, \"clustGeo\")\n```\n\n::: {.cell-output-display}\n![](InClassEx10_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n\n\n\nSoft vs Hard Classification\n\n-   Use Geospatial ; not building exploratory model but do segmentation  group location based on similarity and disimilarity -based on attributes you are interested in\n\n# 4.0 Characterising the Clusters\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggparcoord(data = shan_sf_clustGeo, \n            columns=c(17:21), \n            scale=\"globalminmax\", \n            alphaLines = 0.2, \n            boxplot=TRUE,\n            title=\"Multiple Parallel Coordinates Plots of ICT Variables by Cluster\") + \n  facet_grid(~clustGeo) + \n  theme(axis.text.x = element_text(angle=30))\n```\n\n::: {.cell-output-display}\n![](InClassEx10_files/figure-html/unnamed-chunk-20-1.png){width=1152}\n:::\n:::\n\n\n\n\n\n-   GeoVisualization : Sometimes we can use graph to complement the discussion; do not use ChartJunk\n\n-   This is complementary to the visualization of the clustGeo map\n\n    -   e.g Cluster 2: Low\n\n    -   Correlation - Box Plot (ScatterPlot)\n\n-   Do not remove the line; line means province\n\n## Comparing Cluster Map\n\n1.  LISA vs G\\* - Detect Hotspot and Outliers based on 1 variable - Univariate analysis\n",
    "supporting": [
      "InClassEx10_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}