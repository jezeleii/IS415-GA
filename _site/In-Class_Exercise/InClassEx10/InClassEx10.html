<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-10-21">

<title>In-class 10 – IS415-GA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IS415-GA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Exercise/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1: Geospatial Data Science with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Exercise/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2: Thematic Mapping and GeoVisualisation with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Exercise/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3: 1st &amp; 2nd Order Spatial Point Patterns Analysis Methods</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Exercise/InClassEx04/InClassEx04.html">
 <span class="dropdown-text">Hands-on Exercise 4: Network Constrained Spatial Point Patterns Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Exercise/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5: Spatial Weights and Applications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Exercise/Hands-on_Ex06/Hands-on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6: Global &amp; Local Measures of Spatial Autocorrelation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://jezeleii.shinyapps.io/GAShiny/">
 <span class="dropdown-text">Hands-on Exercise 7:</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Exercise/Hands-on_Ex08/Hands-on_Ex08.html">
 <span class="dropdown-text">Hands-on Exercise 8: Geographical Segmentation with Spatially Constrained Clustering Techniques</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Exercise/InClassEx09/InClassEx09.html">
 <span class="dropdown-text">Hands-on Exercise 9:</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Exercise/Hands-on_Ex10/Hands-on_Ex10.html">
 <span class="dropdown-text">Hands-on Exercise `10: </span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-Class_Exercise/InClassEx01/InClassEx01.html">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Exercise/InClassEx02/InClassEx02.html">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Exercise/InClassEx03/InClassEx03.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Exercise/InClassEx04/InClassEx04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Exercise/InClassEx05/InClassEx05.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Exercise/InClassEx06/InClassEx06.html">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://jezeleii.shinyapps.io/GAShiny/">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Exercise/InClassEx08/InClassEx08.html">
 <span class="dropdown-text">In-class Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Exercise/InClassEx09/InClassEx09.html">
 <span class="dropdown-text">In-class Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Exercise/InClassEx10/InClassEx10.html">
 <span class="dropdown-text">In-class Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-Home_Exercise/TakeHomeEx01/TakeHomeEx01.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-Home_Exercise/TakeHomeEx02/TakeHomeEx02.html">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1.0 Overview</a></li>
  <li><a href="#conventional-hierarchal-clustering" id="toc-conventional-hierarchal-clustering" class="nav-link" data-scroll-target="#conventional-hierarchal-clustering">2.0 Conventional Hierarchal Clustering</a>
  <ul class="collapse">
  <li><a href="#pivot-to-determining-optimal-clusters" id="toc-pivot-to-determining-optimal-clusters" class="nav-link" data-scroll-target="#pivot-to-determining-optimal-clusters">Pivot to Determining Optimal Clusters</a></li>
  </ul></li>
  <li><a href="#spatially-constrained-clustering" id="toc-spatially-constrained-clustering" class="nav-link" data-scroll-target="#spatially-constrained-clustering">3.0 Spatially Constrained Clustering</a>
  <ul class="collapse">
  <li><a href="#skater" id="toc-skater" class="nav-link" data-scroll-target="#skater">3.1 SKATER</a></li>
  <li><a href="#clustgeo-method" id="toc-clustgeo-method" class="nav-link" data-scroll-target="#clustgeo-method">3.2 ClustGeo Method</a></li>
  </ul></li>
  <li><a href="#characterising-the-clusters" id="toc-characterising-the-clusters" class="nav-link" data-scroll-target="#characterising-the-clusters">4.0 Characterising the Clusters</a>
  <ul class="collapse">
  <li><a href="#comparing-cluster-map" id="toc-comparing-cluster-map" class="nav-link" data-scroll-target="#comparing-cluster-map">Comparing Cluster Map</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">In-class 10</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 21, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">October 22, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="overview" class="level1">
<h1>1.0 Overview</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(spdep, sp,tmap, sf,ClustGeo, cluster,factoextra, NbClust, tidyverse, GGally)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>shan_sf <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/shan_sf.rds"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>shan_ict <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/shan_ict.rds"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>shan_sf_cluster <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/shan_sf_cluster.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="conventional-hierarchal-clustering" class="level1">
<h1>2.0 Conventional Hierarchal Clustering</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>proxmat <span class="ot">&lt;-</span> <span class="fu">dist</span>(shan_ict, <span class="at">method =</span> <span class="st">"euclidean"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>hclust_ward <span class="ot">&lt;-</span> <span class="fu">hclust</span>(proxmat, <span class="at">method=</span><span class="st">"ward.D"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">cutree</span>(hclust_ward, <span class="at">k =</span> <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>proxmat - calculates proximity metrics</p></li>
<li><p><a href="https://www.datacamp.com/tutorial/hierarchical-clustering-R">methods</a> to do agglomoration:</p></li>
<li><p>will not understand the argument k if you do not return the hclust() function</p></li>
</ul>
<section id="pivot-to-determining-optimal-clusters" class="level2">
<h2 class="anchored" data-anchor-id="pivot-to-determining-optimal-clusters">Pivot to Determining Optimal Clusters</h2>
<ol type="1">
<li>k.max == 10 ? Is not the same as K or clustering. Is not hierarchal clustering, but is the K of the graphical Plot to Compare Results.</li>
<li>You don’t stop at one even if it is the highest; minimum 3. in the context of the the picture (hands-on 9; it is 6)</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>shan_sf_cluster <span class="ot">&lt;-</span> <span class="fu">cbind</span>(shan_sf, <span class="fu">as.matrix</span>(groups)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">CLUSTER</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">as.matrix.groups.</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">TS =</span> TS.x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>this is an append function, as opposed to a left_join</p></li>
<li><p>an alternative that can work is to use datatable or tibble (in place of shan_sf)</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(shan_sf_cluster, <span class="st">"CLUSTER"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="InClassEx10_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_ward, <span class="at">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(hclust_ward, <span class="at">k =</span> <span class="dv">6</span>, <span class="at">border =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="InClassEx10_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>When clustering; need to consider the spatial relationship of the neighbours ; consider the attribute value but also consider the geographical arrangement of the study area</li>
</ul>
<p>What would be interesting is to produce the cluster but consider geographical homogeneity. -&gt; Spatially Constrained Clustering.</p>
</section>
</section>
<section id="spatially-constrained-clustering" class="level1">
<h1>3.0 Spatially Constrained Clustering</h1>
<p>Methods : SKATER, REDCAP, ClustGeo</p>
<ul>
<li><p>SKATER - Hard Classification</p></li>
<li><p>ClustGeo - Soft Classification</p></li>
</ul>
<section id="skater" class="level2">
<h2 class="anchored" data-anchor-id="skater">3.1 SKATER</h2>
<p>Using Network Graph Methods,</p>
<p><img src="images/Screenshot 2024-10-21 at 9.22.49 AM.png" class="img-fluid"></p>
<ol type="1">
<li>Represent area by a node, and edges represent connections between areas, forming a network. You must always start with a network</li>
</ol>
<!-- -->
<ol start="2" type="1">
<li>Define Edge Cost (Pick up minimum Distance)</li>
<li>Generates only one spinning Tree at the end of the day (purely distance based) - Minimum Spanning Tree</li>
</ol>
<p>Slide: A heuristic for fast tree partitioning</p>
<ol start="4" type="1">
<li>Add an Attribute Value</li>
</ol>
<p>SKATER METHOD</p>
<ol start="4" type="1">
<li>Use poly2nb to find nearest neighbour. Do not need to change it to sp, because the recent versions of spdep, they can accept sf</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>shan.nb <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(shan_sf)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(shan.nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 55 
Number of nonzero links: 264 
Percentage nonzero weights: 8.727273 
Average number of links: 4.8 
Link number distribution:

 2  3  4  5  6  7  8  9 
 5  9  7 21  4  3  5  1 
5 least connected regions:
3 5 7 9 47 with 2 links
1 most connected region:
8 with 9 links</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Visualising the neighbours</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(shan_sf), </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">border=</span><span class="fu">grey</span>(.<span class="dv">5</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>pts <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(shan_sf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: st_centroid assumes attributes are constant over geometries</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shan.nb, </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>     pts, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="st">"blue"</span>, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="InClassEx10_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Useful to explain the construction of the graph. But for the app, you can ignore because it is not of interest to the end user</li>
</ul>
<ol start="3" type="1">
<li>Computing Minimum Spanning Tree</li>
</ol>
<ul>
<li><p>a few processes can be considered</p>
<p>3.1 considering least cost</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>lcosts <span class="ot">&lt;-</span> <span class="fu">nbcosts</span>(shan.nb, shan_ict)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>lcosts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 263.3710 144.0247 430.6407 237.7849

[[2]]
[1] 257.3161 302.5179 204.3295

[[3]]
[1] 257.3161 432.1653

[[4]]
[1] 181.96406  94.61225 138.12050

[[5]]
[1] 263.3710 674.0112

[[6]]
[1] 302.51785 181.96406 140.01101  95.66782 252.26066

[[7]]
[1]  94.61225 139.31874

[[8]]
[1] 204.32952 432.16535 140.01101  90.82891 186.29066 625.18712 249.35081
[8] 274.91604 304.96838

[[9]]
[1]  90.82891 157.04230

[[10]]
[1] 144.0247 186.2907 157.0423 163.9574 347.8594

[[11]]
[1] 592.9074 704.8697 238.6706

[[12]]
[1] 522.96309  78.78999 157.48857 255.83275  59.69478

[[13]]
[1] 374.50873 131.67061 178.09554  92.79567 202.99615 174.67678 110.55197

[[14]]
[1] 374.5087 462.4194 329.2948 531.0802 388.7339

[[15]]
[1] 592.9074 580.3811 310.6081 229.3789 204.5401 392.4857 361.8268

[[16]]
[1] 131.6706 200.3180 150.9805 119.8699 236.7088

[[17]]
[1] 466.3647 177.3379 137.7942 109.0851

[[18]]
[1] 625.1871 522.9631 423.7787 379.3792 352.0653

[[19]]
[1] 466.36472 290.86435 365.88437  79.41836 170.63913 646.66493 429.84475

[[20]]
[1] 178.09554 200.31803  94.98486

[[21]]
[1] 203.0285 506.2994 201.6522 308.1380 585.6178 242.7823

[[22]]
[1] 677.0951 444.0441 432.1012

[[23]]
[1] 331.4262 316.3031 264.6500

[[24]]
[1] 203.0285 113.8092 574.4029 531.3600 445.4062

[[25]]
[1] 249.3508 163.9574 177.3379 423.7787 290.8643 229.4466 195.1768 194.4793

[[26]]
[1] 150.9805 677.0951 356.8492 140.9539 383.7214

[[27]]
[1] 331.42618  57.60801  78.29342 187.40057 347.14183

[[28]]
[1]  78.78999  92.79567 462.41938 273.02385  94.23028 128.20940

[[29]]
[1] 580.3811 635.9204 521.8866 331.6720

[[30]]
[1] 506.29940 316.30314  57.60801 108.37735 364.76893

[[31]]
[1] 365.8844 229.4466 448.5823 240.9555

[[32]]
[1] 444.0441 356.8492 408.0340 221.4761 285.5647

[[33]]
[1] 704.8697 310.6081 635.9204

[[34]]
[1] 202.9962 119.8699 201.6522 113.8092 140.9539 442.8082 158.9048 212.5962

[[35]]
[1] 274.91604 157.48857 379.37916  91.65458 513.76415 124.74445

[[36]]
[1] 138.12050  95.66782 139.31874 225.80242 325.09619

[[37]]
[1] 329.29477  91.65458 225.80242 528.14240 158.84853

[[38]]
[1] 574.4029 408.0340 202.4500 146.6666 315.5755

[[39]]
[1] 229.37894  79.41836 276.19175 162.80878 584.63341

[[40]]
[1] 204.5401 521.8866 276.1918 271.3445

[[41]]
[1] 170.63913  78.29342 331.67199 162.80878 271.34451 412.22167

[[42]]
[1] 238.6706 392.4857 721.8615

[[43]]
[1] 531.3600 383.7214 221.4761 442.8082 202.4500

[[44]]
[1] 174.67678 531.08019 236.70878  94.98486

[[45]]
[1] 308.1380 158.9048 146.6157 146.7889 127.4220

[[46]]
[1] 252.2607 304.9684 513.7642 325.0962 528.1424

[[47]]
[1] 264.6500 187.4006

[[48]]
[1] 255.83275 137.79420 352.06533 195.17677 273.02385 146.61572 278.95182
[8]  47.79331

[[49]]
[1]  59.69478 388.73386  94.23028 124.74445 158.84853

[[50]]
[1] 430.6407 674.0112 361.8268 646.6649 448.5823 584.6334 721.8615 210.4849

[[51]]
[1] 585.6178 445.4062 108.3773 146.6666

[[52]]
[1] 110.5520 128.2094 212.5962 146.7889 278.9518

[[53]]
[1] 432.1012 285.5647 315.5755

[[54]]
[1] 109.08506 429.84475 242.78233 347.14183 364.76893 412.22167 127.42203
[8]  47.79331

[[55]]
[1] 237.7849 347.8594 194.4793 240.9555 210.4849

attr(,"call")
nbcosts(nb = shan.nb, data = shan_ict)
attr(,"class")
[1] "nbdist"</code></pre>
</div>
</div>
<p>3.2 Incorporating costs into a weight object</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>shan.w <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(shan.nb, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                   lcosts, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">style=</span><span class="st">"B"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(shan.w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 55 
Number of nonzero links: 264 
Percentage nonzero weights: 8.727273 
Average number of links: 4.8 
Link number distribution:

 2  3  4  5  6  7  8  9 
 5  9  7 21  4  3  5  1 
5 least connected regions:
3 5 7 9 47 with 2 links
1 most connected region:
8 with 9 links

Weights style: B 
Weights constants summary:
   n   nn       S0       S1        S2
B 55 3025 76267.65 58260785 522016004</code></pre>
</div>
</div>
<ul>
<li>needs to be binary - excludes or includes neigbours, B should be an argument and shouldn’t be exposed as a parameter</li>
</ul>
<p>3.3 Computing MST</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>shan.mst <span class="ot">&lt;-</span> <span class="fu">mstree</span>(shan.w)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>shan.mst</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2]      [,3]
 [1,]   34   24 113.80917
 [2,]   34   16 119.86993
 [3,]   16   13 131.67061
 [4,]   13   28  92.79567
 [5,]   28   12  78.78999
 [6,]   12   49  59.69478
 [7,]   13   52 110.55197
 [8,]   49   35 124.74445
 [9,]   35   37  91.65458
[10,]   34   26 140.95392
[11,]   52   45 146.78891
[12,]   45   54 127.42203
[13,]   54   48  47.79331
[14,]   54   17 109.08506
[15,]   13   44 174.67678
[16,]   44   20  94.98486
[17,]   17   25 177.33790
[18,]   25   10 163.95741
[19,]   10    1 144.02475
[20,]   10    9 157.04230
[21,]    9    8  90.82891
[22,]    8    6 140.01101
[23,]    6   36  95.66782
[24,]   36    4 138.12050
[25,]    4    7  94.61225
[26,]   25   55 194.47928
[27,]   34   21 201.65224
[28,]    8    2 204.32952
[29,]   55   50 210.48485
[30,]   25   31 229.44658
[31,]    6   46 252.26066
[32,]    2    3 257.31610
[33,]    1    5 263.37099
[34,]   25   19 290.86435
[35,]   19   39  79.41836
[36,]   39   41 162.80878
[37,]   41   27  78.29342
[38,]   27   30  57.60801
[39,]   30   51 108.37735
[40,]   51   38 146.66661
[41,]   27   47 187.40057
[42,]   38   43 202.45004
[43,]   43   32 221.47613
[44,]   39   15 229.37894
[45,]   15   40 204.54010
[46,]   47   23 264.64997
[47,]   32   53 285.56475
[48,]   15   33 310.60810
[49,]   37   14 329.29477
[50,]   41   29 331.67199
[51,]   48   18 352.06533
[52,]   15   42 392.48568
[53,]   42   11 238.67060
[54,]   53   22 432.10118
attr(,"class")
[1] "mst"    "matrix"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(shan_sf), </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">border=</span><span class="fu">gray</span>(.<span class="dv">5</span>))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.mst</span>(shan.mst, </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>         pts, <span class="at">col=</span><span class="st">"blue"</span>, </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex.lab=</span><span class="fl">0.7</span>, </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex.circles=</span><span class="fl">0.005</span>, </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="InClassEx10_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<ol start="4" type="1">
<li>Skater Tree</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>skater.clust6 <span class="ot">&lt;-</span> <span class="fu">skater</span>(<span class="at">edges =</span> shan.mst[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> shan_ict, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">method=</span><span class="st">"euclidean"</span>, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ncuts =</span> <span class="dv">5</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>skater.clust6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$groups
 [1] 3 3 6 3 3 3 3 3 3 3 2 1 1 1 2 1 1 1 2 4 1 2 5 1 1 1 2 1 2 2 1 2 2 1 1 3 1 2
[39] 2 2 2 2 2 4 1 3 2 1 1 1 2 1 2 1 1

$edges.groups
$edges.groups[[1]]
$edges.groups[[1]]$node
 [1] 13 48 45 55 52 37 34 16 25 54 35 17 28 12 49 18 50 14 21 31 24 26

$edges.groups[[1]]$edge
      [,1] [,2]      [,3]
 [1,]   48   18 365.12877
 [2,]   55   50 289.28639
 [3,]   45   54 279.32355
 [4,]   37   14 276.76268
 [5,]   34   21 269.69073
 [6,]   34   16 219.58865
 [7,]   52   45 219.06155
 [8,]   25   31 218.04887
 [9,]   16   13 204.70581
[10,]   13   28 198.11085
[11,]   25   55 188.11124
[12,]   34   24 179.51227
[13,]   54   48 139.09943
[14,]   13   52 119.22552
[15,]   34   26  93.16661
[16,]   28   12  88.29377
[17,]   54   17  64.59928
[18,]   35   37  47.73326
[19,]   17   25  45.04693
[20,]   12   49  12.32367
[21,]   49   35 -11.64538

$edges.groups[[1]]$ssw
[1] 3422.74


$edges.groups[[2]]
$edges.groups[[2]]$node
 [1] 47 27 53 38 42 15 41 51 43 32 30 19 39 22 11 33 29 40

$edges.groups[[2]]$edge
      [,1] [,2]       [,3]
 [1,]   53   22 386.684498
 [2,]   15   33 385.897990
 [3,]   42   11 366.675375
 [4,]   38   43 346.581522
 [5,]   41   29 338.133590
 [6,]   51   38 290.135624
 [7,]   15   42 288.993876
 [8,]   27   47 261.376960
 [9,]   15   40 261.319724
[10,]   43   32 260.053478
[11,]   32   53 209.411293
[12,]   30   51 156.366830
[13,]   19   39 118.358401
[14,]   27   30  52.573252
[15,]   39   15  41.915549
[16,]   39   41   6.497483
[17,]   41   27  -8.505392

$edges.groups[[2]]$ssw
[1] 3759.364


$edges.groups[[3]]
$edges.groups[[3]]$node
 [1]  2  6  8  1 36  4 10  9 46  5  7

$edges.groups[[3]]$edge
      [,1] [,2]        [,3]
 [1,]    6   46 355.0727573
 [2,]    1    5 212.8821329
 [3,]    8    2 196.4900911
 [4,]   36    4 163.5355565
 [5,]    4    7 121.5608451
 [6,]    6   36 100.0767619
 [7,]    8    6  43.9202323
 [8,]   10    9  24.8416921
 [9,]   10    1  24.1890957
[10,]    9    8  -0.6180172

$edges.groups[[3]]$ssw
[1] 1458.074


$edges.groups[[4]]
$edges.groups[[4]]$node
[1] 44 20

$edges.groups[[4]]$edge
     [,1] [,2]     [,3]
[1,]   44   20 94.98486

$edges.groups[[4]]$ssw
[1] 94.98486


$edges.groups[[5]]
$edges.groups[[5]]$node
[1] 23

$edges.groups[[5]]$edge
     [,1] [,2] [,3]

$edges.groups[[5]]$ssw
[1] 0


$edges.groups[[6]]
$edges.groups[[6]]$node
[1] 3

$edges.groups[[6]]$edge
     [,1] [,2] [,3]

$edges.groups[[6]]$ssw
[1] 0



$not.prune
NULL

$candidates
[1] 1 2 3 4 5 6

$ssto
[1] 12612.52

$ssw
[1] 12612.515 10977.044  9961.641  9540.422  9122.654  8735.162

$crit
[1]   1 Inf

$vec.crit
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
[39] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1

attr(,"class")
[1] "skater"</code></pre>
</div>
</div>
<ul>
<li><p>n is always k - 1 (because n starts from 0)</p></li>
<li><p>If you do not want to confuse your user; create a parameter where n is what the user places; and the backend processes it as n - 1</p></li>
<li><p>though they have neighbours, in terms of their attribute neighbours they are far from it</p></li>
</ul>
<p>Code chunk to plot the skater tree</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(shan_sf), </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">border=</span><span class="fu">gray</span>(.<span class="dv">5</span>))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(skater.clust6, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>     pts, </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab=</span><span class="fl">0.7</span>, </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">groups.colors=</span><span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"brown"</span>, <span class="st">"pink"</span>), </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.circles=</span><span class="fl">0.005</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1], coords[id2,
: "add" is not a graphical parameter
Warning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1], coords[id2,
: "add" is not a graphical parameter
Warning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1], coords[id2,
: "add" is not a graphical parameter
Warning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1], coords[id2,
: "add" is not a graphical parameter</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="InClassEx10_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<ol start="6" type="1">
<li>Visualizing the clusters in a chorpleth Map</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>groups_mat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(skater.clust6<span class="sc">$</span>groups)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>shan_sf_spatialcluster <span class="ot">&lt;-</span> <span class="fu">cbind</span>(shan_sf_cluster, <span class="fu">as.factor</span>(groups_mat)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">skater_CLUSTER</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">as.factor.groups_mat.</span><span class="st">`</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(shan_sf_spatialcluster, <span class="st">"skater_CLUSTER"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="InClassEx10_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>we use as factor, instead of as character, because for numerical value, it will be automatically organized.</p>
<ul>
<li><p>if we are using month; be careful of using ascending order</p></li>
<li><p>function to convert group object into a factor (second line) ; what we really want is the group field (groups)</p></li>
</ul></li>
</ul>
<p>Conclusion: Useful, considered as Hard Classification as it is using nearest neighbour. All classification is based on a minimum spanning tree.</p>
</section>
<section id="clustgeo-method" class="level2">
<h2 class="anchored" data-anchor-id="clustgeo-method">3.2 ClustGeo Method</h2>
<p>Soft Classification method, allowing us to decide how many proportion of the attribute we want to use and how many proportion of spatial we want to use (?)</p>
<ul>
<li>At what cutoff point you want to have a spatially constrained analysis. Interpretation is eyebaleld at the intersection. Once detected, we read downward and take the cutoff value. If the user wants to emphasise more on the spatial interaction (needs to increase in the D3)</li>
</ul>
<ol type="1">
<li><p>Computing Spatial Distance Matrix</p></li>
<li><p>The Cluster Graphs</p></li>
<li><p>The Code</p></li>
<li><p>Saving clustGeoOutput</p></li>
<li><p>Computing Spatial Distance Matrix</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(shan_sf, shan_sf)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>distmat <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(dist)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>distmat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            1          2          3          4          5          6          7
2  195556.505                                                                  
3  129387.742      0.000                                                       
4  263507.011  20287.139  35045.819                                            
5       0.000 235922.248 170256.882 303641.675                                 
6  206100.802      0.000   5918.623      0.000 246913.514                      
7  323534.459  89844.904 104686.167      0.000 366407.917  62016.362           
8   69522.935      0.000      0.000  54865.392 114370.764      0.000 113520.171
9   23022.686  90556.539  24837.389 158164.723  49220.458 100667.381 217177.595
10      0.000 125878.894  61496.303 193218.233  35690.821 135852.908 246848.941
11  86379.395 304705.838 243351.150 369959.441  50976.372 313290.202 417813.257
12 169809.951  66109.333  67984.860 104005.110 216670.451  57512.865 129799.472
13 253312.412  95697.255 110713.509  80265.740 299034.814  80291.953  73365.690
14 271081.363  82018.859  97252.671  38887.572 317186.716  65295.782  24164.519
15  54016.405 257508.461 195772.184 323183.597  35052.355 266543.534 372976.783
16 285264.789 181001.427 194500.970 154388.211 329118.347 167920.605 139912.573
17  95471.826 168583.147 125298.657 221420.369 115008.528 169057.458 254278.121
18 100263.905  61048.429  34734.035 116432.966 148209.911  61376.634 162462.775
19  56159.890 185884.336 129195.094 249676.927  59292.850 193077.470 296950.715
20 300991.436 145702.569 160931.848 109987.964 349107.582 128799.835  96151.976
21 187467.334 197890.954 180793.621 225025.234 207571.240 189124.671 232754.070
22 346871.303 277251.030 285386.281 268263.171 379768.207 264791.943 255124.680
23 200861.675 270885.571 239361.421 312273.553 191002.354 267251.608 328350.762
24 238059.685 233701.918 218542.382 260252.959 263030.313 225446.129 264028.091
25  26041.159 115054.691  60636.027 179571.017  67317.991 122902.102 226884.133
26 308358.355 233030.728 242922.008 215969.198 343590.934 219146.677 202619.694
27 155844.022 271643.367 224433.981 325475.131 146153.005 274268.249 351356.260
28 215441.818  76693.744  91669.580  64814.007 263056.133  61551.509  68332.880
29 153710.825 320261.543 267478.292 379988.297 124408.683 324643.830 415583.879
30 161431.340 223082.170 192124.994 268058.340 157252.237 220518.884 289883.659
31  19075.492 184510.055 122148.576 250903.422  32615.481 194106.473 303810.701
32 338736.603 277547.243 283513.348 272384.959 369756.965 265419.379 259397.390
33 146179.586 343224.804 286891.346 405219.593 111473.353 349111.896 444127.535
34 226142.268 177565.034 182866.086 176977.401 261405.930 165257.485 168069.584
35 163288.621  27830.180  27714.596  39674.472 207752.013  18086.000  62189.187
36 238257.757  16287.476  30940.939      0.000 280781.462      0.000      0.000
37 258443.625  52324.676  67434.780  12565.296 303532.869  34676.934   1708.688
38 310443.752 304907.121 295917.034 323831.359 322064.103 295060.668 318966.394
39  59815.622 244039.406 183495.192 309163.893  52450.220 252494.485 356827.842
40 137576.151 299723.401 249154.788 357747.584 115224.161 303248.846 391268.599
41 140386.923 270807.815 223402.858 327471.691 125474.227 273566.667 360186.149
42  36623.068 269890.893 205947.553 336462.106    684.660 279578.115 387995.580
43 293579.127 253773.622 257196.660 257259.479 320401.835 241956.554 246513.434
44 284036.690 118379.917 133610.408  65160.921 332148.697 101862.990  50376.780
45 169757.201 161351.489 142270.891 198015.943 202155.178 155176.962 212408.422
46 203107.401   7348.896  20334.461   7930.656 247622.558      0.000  20143.853
47 205997.158 296139.668 257843.898 344937.638 190739.504 295423.885 366865.511
48 129325.816 120151.016  93546.254 160082.228 174418.520 115048.928 172421.057
49 189677.309  58462.352  68420.604  60286.544 236878.351  47868.999  62561.579
50      0.000 219743.016 153859.023 287498.759      0.000 229997.198 345509.329
51 238175.538 250932.863 232195.418 283133.329 249718.983 244116.083 291525.501
52 207050.341 150928.728 152462.426 164615.483 243750.148 140164.178 161766.535
53 364419.326 333951.035 333052.730 341093.856 378319.613 322743.462 328011.755
54 108778.098 190392.856 158772.456 230605.090 109101.542 187038.310 248355.010
55      0.000 179178.881 114134.538 246614.680  18145.243 189194.177 303417.068
            8          9         10         11         12         13         14
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9       0.000                                                                  
10      0.000      0.000                                                       
11 175320.795 173212.023 116207.683                                            
12  19258.901  76755.290  86042.045 230556.039                                 
13  76741.564 163497.805 169554.442 302459.474  24821.510                      
14  72791.804 167722.650 189805.990 352908.098  59860.837      0.000           
15 127836.395 127318.108  73206.058      0.000 188909.527 263692.304 309507.790
16 147131.153 205247.726 201893.922 326060.272  59133.110      0.000  73449.151
17  60943.072  88002.449  47262.179  94474.936  61764.462 122173.412 183868.288
18      0.000  25350.746  16943.002 182787.768      0.000  76461.055 100592.314
19  61392.064  76323.846  35892.441  52425.182 114397.292 191975.262 233357.198
20 130809.241 208788.342 217363.475 357462.076  65676.449      0.000  22456.174
21 130031.042 161755.314 128777.451 176635.114  60507.647  69837.820 150220.997
22 236938.078 286141.113 269211.866 351246.195 142949.414  90227.682 172872.361
23 177680.902 207807.558 167250.840 134857.318 141508.495 167915.044 247633.487
24 168774.977 200499.099 169883.097 227146.230  96168.166  93458.470 179537.644
25      0.000  22243.772      0.000  98295.041  39244.113 120134.519 161050.913
26 194667.840 245235.206 229378.107 321225.185 100927.717  38077.228 122131.998
27 158092.508 178939.909 139166.450  96980.140 159208.239 204142.982 275608.822
28  51088.836 119515.171 132399.342 273369.585      0.000      0.000      0.000
29 199971.871 214371.495 165320.168  24145.516 223046.171 279693.091 345753.566
30 132246.631 164123.403 125800.409 111564.212  98595.073 142762.901 213150.606
31  54427.919  59130.535  17411.578  49699.980 132021.856 214291.372 244370.721
32 234997.676 282169.074 262552.405 335900.573 140851.199  93919.413 176420.525
33 218404.140 225277.471 171424.519      0.000 251688.292 311140.002 375404.019
34 135055.043 171977.382 149125.676 245775.738  47718.421      0.000  82051.347
35      0.000  57498.939  83302.701 252124.698      0.000  23306.582   8898.476
36  28059.016 131916.748 163665.969 338647.153  67833.099  63593.876  24694.074
37  54304.353 153326.666 178992.549 347137.118  60456.115  17787.982      0.000
38 248035.930 279686.832 247884.342 273957.054 164271.288 144508.042 232803.986
39 115121.934 119264.883  67566.417  31211.561 168622.877 241325.490 291247.975
40 181526.031 195585.173 146862.747  36419.627 199001.491 253417.272 320275.237
41 157001.423 177262.345 137606.320  63576.332 168035.655 222841.109 289203.825
42 139770.820 127988.737  68755.193      0.000 206680.393 283714.108 325853.818
43 208735.725 247092.921 221343.800 283290.577 115430.776  78095.134 161364.589
44 104113.054 191095.191 200427.479 342467.482  48734.844      0.000      0.000
45  93899.883 125172.546  97363.790 183922.200  27316.069  62414.561 133276.273
46      0.000  97367.068 125599.346 298943.942  31696.588  47458.150  25900.228
47 194315.118 220682.275 180631.221 123043.209 176240.242 211489.350 288259.336
48  40286.821  71645.864  47197.328 171020.080      0.000  27439.837  93784.752
49  24400.983  91176.153 107084.057 269523.649      0.000  15778.131      0.000
50  92350.383  71036.705  11622.534  37842.609 176923.960 253267.419 290153.337
51 178121.527 210248.552 176300.297 206410.180 114676.272 123955.574 208242.120
52 103772.692 150364.110 129276.805 232518.473   9924.623      0.000  76507.724
53 284464.119 322816.681 295429.670 325019.850 192995.311 161422.735 244990.784
54  94110.951 119059.122  78962.685  82702.314  59872.389  99870.382 170415.727
55  51290.239  34881.648      0.000  88772.043 141604.664 224443.761 247667.854
           15         16         17         18         19         20         21
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9                                                                              
10                                                                             
11                                                                             
12                                                                             
13                                                                             
14                                                                             
15                                                                             
16 286743.896                                                                  
17  55732.556 146051.070                                                       
18 138013.530 108961.702  38321.692                                            
19   9953.833 219564.130      0.000  61888.281                                 
20 318708.836      0.000 177042.592 122889.257 245797.451                      
21 131924.670  81716.806  27872.779  69178.400  79746.979 112269.006           
22 301783.472  38986.249 185712.357 184737.030 251910.793  89571.634  93205.892
23  83459.767 178904.732  71100.239 137469.536  45924.303 209460.437  15971.532
24 176512.420 100634.425  73368.887 106466.043 127382.984 131065.752      0.000
25  51796.921 150616.681      0.000      0.000      0.000 171864.246  59534.970
26 274673.067      0.000 149954.796 143832.727 223319.208  37046.211  59260.377
27  45205.840 217778.804  48744.354 139874.443   1007.634 249086.524  50859.614
28 234620.624  23743.654  93306.250  41359.924 162103.353  28976.742  48550.840
29      0.000 296684.458  89204.612 189821.842  35147.961 329682.929 135492.326
30  60002.954 156410.476  25164.078  89848.488  14024.033 186966.473      0.000
31   3273.070 244243.532  30426.367  70720.773      0.000 265148.939 124334.456
32 284286.622  54288.243 176052.153 180683.527 239127.824  94200.785  83845.774
33      0.000 328847.700 114022.872 214872.141  62357.918 361771.160 169464.506
34 202405.645      0.000  69029.846  70925.251 145941.732  25967.588      0.000
35 206902.736 108339.459  97150.338      0.000 131024.997  72482.742 121963.238
36 292422.633 140186.697 185541.367  82804.129 217723.180  96090.992 190810.138
37 302844.670 109203.536 183367.233  92711.798 226574.115  60470.353 169415.052
38 222499.815 124429.217 149617.042 183481.271 179176.711 160260.947  66345.300
39      0.000 265532.486  34479.418 122282.314      0.000 296313.408 109449.369
40      0.000 269855.975  70226.672 168377.604  13221.297 302757.851 109598.400
41  20257.687 240272.364  46532.820 139052.487      0.000 273170.669  83127.720
42      0.000 310029.817  82437.185 153598.888  27910.843 338018.468 171814.436
43 231750.599  53508.849 128945.341 146315.715 183807.805  85553.918  40404.674
44 303248.084      0.000 163054.881 105938.659 229508.771      0.000 117481.005
45 143641.853  81129.916   8591.072  30706.586  85234.441 113184.562      0.000
46 253047.507 137449.905 147298.301  42752.576 177875.163  89233.741 162626.986
47  76179.452 223535.788  89770.573 165022.484  50704.136 254088.519  56678.100
48 132269.455  54561.836      0.000      0.000  64067.821  82450.454  27306.912
49 225575.753  93836.721 106752.454  16766.049 149329.065  62478.632 113903.139
50      0.000 279612.631  53522.022 116632.142      0.000 307701.276 143972.927
51 154619.356 131136.524  77449.876 121307.323 108526.604 161422.312      0.000
52 192861.022  12265.196  54294.794  49021.534 129699.659  44113.815   6823.544
53 274943.790 116554.761 199908.587 222478.778 234116.468 162372.855 113237.596
54  41609.200 116394.326      0.000  58210.284      0.000 149143.417      0.000
55  42026.540 255059.017  55111.529  74436.367  17333.439 274000.806 148722.005
           22         23         24         25         26         27         28
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9                                                                              
10                                                                             
11                                                                             
12                                                                             
13                                                                             
14                                                                             
15                                                                             
16                                                                             
17                                                                             
18                                                                             
19                                                                             
20                                                                             
21                                                                             
22                                                                             
23 169673.189                                                                  
24  70699.532  47406.646                                                       
25 203711.257 104152.491  97909.545                                            
26      0.000 148926.851  54743.696 165849.744                                 
27 213463.438      0.000  89709.163  75860.932 191247.775                      
28 115660.539 145601.524  81382.530  90348.276  72517.463 176102.855           
29 299766.056  76334.894 175925.551 115037.581 277255.534  33207.483 250902.425
30 149070.094      0.000  25953.669  57663.181 127534.130      0.000 113789.285
31 293330.174 133452.322 178175.678      0.000 257001.417  90406.278 184108.828
32      0.000 142831.466  33640.177 195363.494      0.000 190758.261 114664.715
33 336028.146 112800.617 211068.537 136438.634 311361.367  71441.170 282450.005
34  26475.714  75441.994      0.000  83329.338      0.000 118029.451  16970.497
35 205751.627 194859.948 157840.084  63354.834 160860.936 201996.065   4288.960
36 251696.986 276387.576 226522.189 148802.619 200681.960 289282.043  46314.607
37 208098.014 262669.230 202813.957 155820.538 158368.866 282302.722   4175.507
38  35736.788  80900.402      0.000 175742.936  60025.272 128886.694 146379.816
39 279039.163  59098.616 153758.237  37538.658 252196.448  22403.919 212012.869
40 276586.490  53823.256 151399.780  96937.024 251377.330  15328.025 224573.492
41 253448.297  34787.787 128440.482  74016.863 225749.554      0.000 194060.704
42 347200.935 151965.444 227250.519  66410.626 313784.638 108917.695 253982.095
43  14568.329  93843.504      0.000 151048.480      0.000 140088.193  90556.090
44 122236.692 215706.503 143419.905 155279.706  69157.169 247803.233  14298.628
45 116473.199  70818.630  32864.767  27123.931  79015.689  83152.630  33488.153
46 235566.263 242309.130 198967.174 109361.127 187586.148 251853.426  29223.461
47 212225.147      0.000  92554.244 121764.070 193833.083      0.000 186794.381
48 132124.849  77804.189  63737.142      0.000  90774.721  84852.486      0.000
49 188845.623 195289.089 150029.209  78092.739 144899.441 208572.815      0.000
50 318554.171 134548.542 199395.883  32306.880 284471.830  89504.443 223550.876
51  90554.623  21071.178      0.000 104471.663  83357.559  63699.799 107383.136
52  71462.052  97438.692  41814.657  64825.750  30404.050 127906.111      0.000
53      0.000 134160.494  34307.742 224013.045  63305.323 181687.904 171923.212
54 146624.123  28479.224  27923.206  20184.852 111999.009      0.000  70948.098
55 311837.843 159847.985 200228.148      0.000 273958.007 117314.838 189961.258
           29         30         31         32         33         34         35
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9                                                                              
10                                                                             
11                                                                             
12                                                                             
13                                                                             
14                                                                             
15                                                                             
16                                                                             
17                                                                             
18                                                                             
19                                                                             
20                                                                             
21                                                                             
22                                                                             
23                                                                             
24                                                                             
25                                                                             
26                                                                             
27                                                                             
28                                                                             
29                                                                             
30  63442.979                                                                  
31  98903.717  92729.359                                                       
32 272613.576 128643.087 283624.938                                            
33      0.000  96071.092 101504.639 311977.885                                 
34 204319.773  54190.231 174850.937  21775.586 238925.579                      
35 255785.928 147721.613 138657.157 207557.988 282482.843 107558.930           
36 344873.821 231853.593 221305.760 253783.217 371234.630 154161.769  13848.369
37 344649.962 221748.266 235099.156 211216.500 373002.882 113868.068      0.000
38 210829.613  68179.724 245997.343      0.000 250046.941  35019.713 231161.923
39  13521.972  37246.683   2696.464 260141.508  41117.910 179870.442 191755.549
40      0.000  36186.716  81007.403 254359.002   6889.527 178937.894 233250.183
41      0.000  13196.585  79110.667 234261.722  37763.554 153543.832 202938.612
42  66439.690 120189.371  16240.208 335900.892  48781.075 233963.260 222029.525
43 225166.273  75856.151 235519.089      0.000 263093.927      0.000 186035.416
44 322061.781 185441.682 248357.608 131237.411 353342.422  40807.441  45078.467
45 155175.006  22914.075 115566.939 108574.163 186853.147      0.000  84880.469
46 305442.382 196285.831 182788.529 238103.803 331398.854 138725.489      0.000
47  56919.878   9198.532 143208.224 177145.542  95905.483 120367.533 222677.438
48 151812.910  29079.430  89699.902 127416.080 182810.791  20852.433  43712.915
49 267867.558 150400.574 160341.491 188735.686 295926.720  89092.659      0.000
50  94428.403  97337.055      0.000 307598.589  93496.700 204097.484 183643.689
51 149915.672      0.000 174128.118  55956.044 186687.158  23501.863 174761.923
52 204348.300  65926.706 157384.229  69103.168 236109.237      0.000  82366.146
53 258666.879 124789.006 302511.961      0.000 297394.265  67841.275 264296.156
54  55740.365      0.000  39419.691 135336.403  87776.147  33940.005 115690.277
55 133828.308 118611.247      0.000 303093.901 140256.228 191462.885 141156.114
           36         37         38         39         40         41         42
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9                                                                              
10                                                                             
11                                                                             
12                                                                             
13                                                                             
14                                                                             
15                                                                             
16                                                                             
17                                                                             
18                                                                             
19                                                                             
20                                                                             
21                                                                             
22                                                                             
23                                                                             
24                                                                             
25                                                                             
26                                                                             
27                                                                             
28                                                                             
29                                                                             
30                                                                             
31                                                                             
32                                                                             
33                                                                             
34                                                                             
35                                                                             
36                                                                             
37      0.000                                                                  
38 292796.216 262033.132                                                       
39 277930.329 285933.283 198266.437                                            
40 322275.806 320573.959 192377.211      0.000                                 
41 291834.747 289554.579 172320.811      0.000      0.000                      
42 306464.352 318383.184 285093.084  16326.464  66835.105  85417.567           
43 232795.959 194136.688      0.000 208711.961 204269.623 184348.758 284185.134
44  50984.811  23937.344 191175.415 280877.908 295879.190 265210.705 321785.748
45 162233.622 146775.783 105304.002 122905.763 128840.878  98351.555 172253.091
46      0.000      0.000 268494.879 238333.580 283210.869 253018.963 267495.569
47 308651.712 299303.244 116214.777  52120.568  42324.552  19825.273 146427.184
48 124910.268 107359.439 135858.697 109915.396 126039.549  95061.641 153308.247
49  39972.046      0.000 218134.447 208215.867 244169.515 213296.453 241675.613
50 260845.950 278849.699 260368.557      0.000  77029.698  75310.028      0.000
51 248355.641 228404.868      0.000 131369.778 127538.947 107703.973 212823.532
52 136404.086 102885.775 107196.369 172099.153 177902.608 147567.823 218458.652
53 315775.248 277980.647      0.000 250358.448 243245.215 221894.763 341271.294
54 194804.713 181452.643  99543.838  24012.774  29438.425      0.000  73080.059
55 219087.619 236421.025 271230.783  35889.646 115413.103 109637.057  49078.246
           43         44         45         46         47         48         49
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9                                                                              
10                                                                             
11                                                                             
12                                                                             
13                                                                             
14                                                                             
15                                                                             
16                                                                             
17                                                                             
18                                                                             
19                                                                             
20                                                                             
21                                                                             
22                                                                             
23                                                                             
24                                                                             
25                                                                             
26                                                                             
27                                                                             
28                                                                             
29                                                                             
30                                                                             
31                                                                             
32                                                                             
33                                                                             
34                                                                             
35                                                                             
36                                                                             
37                                                                             
38                                                                             
39                                                                             
40                                                                             
41                                                                             
42                                                                             
43                                                                             
44 117459.147                                                                  
45  68795.138 105082.383                                                       
46 216210.182  54380.402 129406.561                                            
47 134304.264 257958.687 100101.929 272129.659                                 
48  95170.913  69383.140      0.000  90024.245 103809.173                      
49 164718.269  35858.181  81670.355  21749.075 227338.872  44009.601           
50 256983.422 291544.062 142673.963 224397.807 140177.948 122890.459 207183.117
51  21690.397 173579.294  51662.562 217969.781  64431.054  69938.773 169999.413
52  44084.518  41698.742      0.000 113710.328 138113.640      0.000  62757.414
53   1753.424 200479.251 144614.077 296525.797 161160.760 171280.715 245036.492
54  85445.746 142542.993      0.000 161541.116  38226.638      0.000 114028.271
55 256558.082 257096.351 133759.089 182205.445 169812.337  99672.594 164860.216
           50         51         52         53         54
2                                                        
3                                                        
4                                                        
5                                                        
6                                                        
7                                                        
8                                                        
9                                                        
10                                                       
11                                                       
12                                                       
13                                                       
14                                                       
15                                                       
16                                                       
17                                                       
18                                                       
19                                                       
20                                                       
21                                                       
22                                                       
23                                                       
24                                                       
25                                                       
26                                                       
27                                                       
28                                                       
29                                                       
30                                                       
31                                                       
32                                                       
33                                                       
34                                                       
35                                                       
36                                                       
37                                                       
38                                                       
39                                                       
40                                                       
41                                                       
42                                                       
43                                                       
44                                                       
45                                                       
46                                                       
47                                                       
48                                                       
49                                                       
50                                                       
51 187794.242                                            
52 188300.401  63878.816                                 
53 317236.639  40678.306 125620.201                      
54  46163.695  27513.774  24024.975 152519.692           
55      0.000 199446.230 172789.492 326159.319  65731.590</code></pre>
</div>
</div>
<ul>
<li>tibble data format, as.dist to make it into a matrix</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>cr <span class="ot">&lt;-</span> <span class="fu">choicealpha</span>(proxmat, distmat, <span class="at">range.alpha=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>), </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">K=</span><span class="dv">6</span>, <span class="at">graph=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="InClassEx10_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="InClassEx10_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>allows us to see how we want to do the cut off</p></li>
<li><p>proxmat - hierarchal clustering</p></li>
<li><p>distmat - calculated based on the centroid</p></li>
<li><p>alpha range - always 0 - 1.</p></li>
<li><p>breakout (0.1) intervals</p></li>
</ul>
<p>2 graphs; usually refer to the 1st one – if you use the first, for explanation. useful for end user to decide the cutoff</p>
<ul>
<li><p>Use Raw (1st one) - reflects the true value</p></li>
<li><p>2nd is standardized. Purpose: allow you to better understand if you want to compare line 1 and line 2 — see the differences better ; allows you to see how the values change at the absolute point</p></li>
</ul>
<ol start="4" type="1">
<li>Save clustGeoOutput</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>clustG <span class="ot">&lt;-</span> <span class="fu">hclustgeo</span>(proxmat, distmat, <span class="at">alpha=</span><span class="fl">0.2</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">cutree</span>(clustG, <span class="at">k=</span><span class="dv">6</span>))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>shan_sf_clustGeo <span class="ot">&lt;-</span> <span class="fu">cbind</span>(shan_sf, <span class="fu">as.matrix</span>(groups)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">clustGeo</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">as.matrix.groups.</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Explanation:</p>
<ol type="1">
<li>For Users, have a UI for user to decide what value they want to use (slider input) – this is where you apply intercept.</li>
<li>Once you have this part, the interface should stop; after selecting value; it updates the backend; if not it keeps writing in and displaying out</li>
</ol>
<p>Visualizing the clustGeomap</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(shan_sf_clustGeo, <span class="st">"clustGeo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="InClassEx10_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Soft vs Hard Classification</p>
<ul>
<li>Use Geospatial ; not building exploratory model but do segmentation – group location based on similarity and disimilarity -based on attributes you are interested in</li>
</ul>
</section>
</section>
<section id="characterising-the-clusters" class="level1">
<h1>4.0 Characterising the Clusters</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(<span class="at">data =</span> shan_sf_clustGeo, </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">columns=</span><span class="fu">c</span>(<span class="dv">17</span><span class="sc">:</span><span class="dv">21</span>), </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">scale=</span><span class="st">"globalminmax"</span>, </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">alphaLines =</span> <span class="fl">0.2</span>, </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">boxplot=</span><span class="cn">TRUE</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">title=</span><span class="st">"Multiple Parallel Coordinates Plots of ICT Variables by Cluster"</span>) <span class="sc">+</span> </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>clustGeo) <span class="sc">+</span> </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">30</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="InClassEx10_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>GeoVisualization : Sometimes we can use graph to complement the discussion; do not use ChartJunk</p></li>
<li><p>This is complementary to the visualization of the clustGeo map</p>
<ul>
<li><p>e.g Cluster 2: Low</p></li>
<li><p>Correlation - Box Plot (ScatterPlot)</p></li>
</ul></li>
<li><p>Do not remove the line; line means province</p></li>
</ul>
<section id="comparing-cluster-map" class="level2">
<h2 class="anchored" data-anchor-id="comparing-cluster-map">Comparing Cluster Map</h2>
<ol type="1">
<li>LISA vs G* - Detect Hotspot and Outliers based on 1 variable - Univariate analysis</li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>